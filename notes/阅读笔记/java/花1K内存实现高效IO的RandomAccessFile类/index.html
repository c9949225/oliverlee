<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head>


  

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>花1K内存实现高效I/O的RandomAccessFile类</title>
<meta http-equiv="PICS-Label" content="(PICS-1.1 
&quot;http://www.icra.org/ratingsv02.html&quot; l gen true r (cz 1 lz 1 
nz 1 oz 1 vz 1) &quot;http://www.rsac.org/ratingsv01.html&quot; l gen 
true r (n 0 s 0 v 0 l 0) &quot;http://www.classify.org/safesurf/&quot; l
 gen true r (SS~~000 1))">
<link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
<link rel="SHORTCUT ICON" href="http://www.ibm.com/favicon.ico">
  <meta name="Owner" content="dw@cn.ibm.com">
  <meta name="DC.Language" scheme="rfc1766" content="zh-CN">
  <meta name="IBM.Country" content="CN">
<meta name="Security" content="Public">
<meta name="IBM.SpecialPurpose" content="SP001">
<meta name="IBM.PageAttributes" content="sid=1003">
<meta name="Source" content="v16 Template Generator">
<meta name="Robots" content="index,follow">
<meta name="Abstract" 
content="JAVA的文件随机存取类（RandomAccessFile）的I/O效率较低。通过分析其中原因，提出解决方案。逐步展示如何创建
具备缓存读写能力的文件随机存取类，并进行了优化。通过与其它文件访问类的性能对比，证明了其实用价值。">
<meta name="Description" 
content="JAVA的文件随机存取类（RandomAccessFile）的I/O效率较低。通过分析其中原因，提出解决方案。逐步展示如何创建
具备缓存读写能力的文件随机存取类，并进行了优化。通过与其它文件访问类的性能对比，证明了其实用价值。">
<meta name="Keywords" content="java,io,java io,编程,, tttjca">
<meta name="DC.Date" scheme="iso8601" content="2002-11-18">
<meta name="DC.Type" scheme="IBM_ContentClassTaxonomy" content="CT316">
<meta name="DC.Subject" scheme="IBM_SubjectTaxonomy" content="TT300">
<meta scheme="IBM_WTMCategory" name="IBM.WTMCategory" 
content="SOFDCJVACN">
<meta name="DC.Rights" content="© Copyright&nbsp;IBM 
Corporation&nbsp;2002">
<meta name="IBM.Effective" scheme="W3CDTF" content="2002-11-18">
<meta name="title" content="花1K内存实现高效I/O的RandomAccessFile类">

<!-- HEADER_SCRIPTS_AND_CSS_INCLUDE -->
<link href="index_files/all.css" media="all" rel="stylesheet" 
title="www" type="text/css">
<link href="index_files/screen.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/screen-uas.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/screen-fonts.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/handheld.css" media="handheld" rel="stylesheet" 
title="www" type="text/css">
<link href="index_files/print.css" media="print" rel="stylesheet" 
title="www" type="text/css">
<!-- dW-specific CSS -->
<link href="index_files/dw-screen.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/dw-local-site.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/jquery.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">

<script src="index_files/ibmcommon.js" type="text/javascript">//</script><link
 title="IBM Search" 
href="http://www.ibm.com/search/opensearch/description.xml" 
type="application/opensearchdescription+xml" rel="search">
<script src="index_files/dynamicnav.js" type="text/javascript">//</script>
<!-- Pull-down script --> 
<script type="text/javascript" src="index_files/dropdown.js">//</script>
<!-- dW functional JS -->
<script language="JavaScript" src="index_files/urltactic.js" type="text/javascript"></script>
<!-- Rating_START -->

<script language="JavaScript" type="text/javascript">
  // <![CDATA[

 dwr = {};
  dwr.clickhere = '点击评分';
  dwr.stars = '星';
  dwr.star = '星'; 
  dwr.avgRatingOf = '平均分';
  dwr.youRated = '您的评分是';
  dwr.avgRating = '平均分';
  dwr.basedOnVote = '共 {1} 个评分'; // {1} to be substitue by code
  dwr.basedOnVotes = '共 {1} 个评分';
  dwr.leftParen = '（'; 
  dwr.rightParen = ' ）'; 
  dwr.space = ' '; 
  dwr.yourRating = '您的评分';

// ]]>
</script>


<script language="JavaScript" src="index_files/artrating.js" type="text/javascript"></script>
<style type="text/css">
.metavalue {
  display: none;
}
</style>
<!-- Rating_END --><!-- RESERVED_HEADER_INCLUDE -->
<script language="javascript" src="index_files/ajax1.js" type="text/javascript"></script>
<script language="javascript" src="index_files/search_counter-maverick.js" type="text/javascript"></script>
<script language="javascript" src="index_files/request_referer_capture-maverick.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
 <!--
 setDefaultQuery('defaultHere');
 //-->
</script>
<script language="JavaScript" type="text/javascript">
 <!--
 function openNewWindow(url,tar,arg){window.open(url,tar,arg);}
 //-->
</script>
  <!-- Include file support -->
  <script language="JavaScript" type="text/javascript">
    (function($) {
    jQuery.extend({
    getInc: function(u,d){
    if(u==null)return;
    jQuery.ajax({
    type: "GET",
    url: u,
    dataType: "text",
    success: function(t) {
    jQuery(d).html(t);
    ibmCommon.initShowHide(jQuery(d).children()[0]);	
    },
    async: true
    });
    }
    });
    })(jQuery);
  </script>
<script charset="UTF-8" src="index_files/flash-detect.js" type="text/javascript" id="flashdetect"></script><script charset="UTF-8" src="index_files/cnzh-utf8.js" type="text/javascript" id="mhMenu"></script><script charset="UTF-8" src="index_files/Controller_002" type="text/javascript" id="dynavEA"></script><script charset="UTF-8" src="index_files/Controller" type="text/javascript" id="wiBundle"></script></head><body
 id="ibm-com">
<div id="ibm-top" class="ibm-landing-page">

<!-- MASTHEAD_BEGIN -->
<div class="ibm-access"><a href="#main">跳转到主要内容</a></div><div 
id="ibm-masthead"><div id="ibm-logo"><a href="http://www.ibm.com/cn/zh/"><img
 src="index_files/ibm-logo.gif" alt="IBM®" height="50" width="110"></a></div><ul
 id="ibm-geo"><li class="ibm-first" id="ibm-country">中国</li><li 
id="ibm-change-country">[ <a 
href="http://www.ibm.com/developerworks/cn/country/">选择</a> ]</li></ul><form
 id="ibm-search-form" 
action="//www.ibm.com/developerworks/search/searchResults.jsp" 
method="get" name="form1"><input name="searchType" value="1" 
type="hidden"><input name="searchSite" value="dWChina" type="hidden"><input
 name="pageLang" value="zh" type="hidden"><input name="langEncoding" 
value="UTF8" type="hidden"><p><span id="ibm-search-scope"><label 
for="sn"><img src="index_files/c_002.gif" alt="Search in:" height="1" 
width="1"></label><select class="input-local" name="searchScope" id="sn"
 size="1"><option value="dW" selected="selected">dW 全部内容</option><option
 value="dW">--------------</option><option value="aixunix">&nbsp;&nbsp;AIX
 and UNIX</option><option value="dmdd">&nbsp;&nbsp;Info Mgmt</option><option
 value="lotusdd">&nbsp;&nbsp;Lotus</option><option value="rdd">&nbsp;&nbsp;Rational</option><option
 value="wsdd">&nbsp;&nbsp;WebSphere</option><option value="dW">--------------</option><option
 value="javaZ">&nbsp;&nbsp;Java technology</option><option 
value="linuxZ">&nbsp;&nbsp;Linux</option><option value="opensrcZ">&nbsp;&nbsp;Open
 source</option><option value="webservZ">&nbsp;&nbsp;SOA &amp; Web 
services</option><option value="webarchZ">&nbsp;&nbsp;Web dev</option><option
 value="xmlZ">&nbsp;&nbsp;XML</option><option value="dW">--------------</option><option
 value="all">IBM 全部内容</option></select></span><label for="q"><img 
alt="搜索:" src="index_files/c_002.gif" height="1" width="1"></label><input
 name="query" maxlength="100" id="q" type="text"><input id="ibm-search" 
class="ibm-btn-search" name="Search" value="搜索" type="submit"></p></form><div
 id="ibm-site-name"><!-- IBM site name container --></div><div 
id="ibm-universal-nav"><ul><li class="ibm-first" id="ibm-unav-home"><a 
href="http://www.ibm.com/cn/zh/">首页</a></li><li id="ibm-unav-solutions"><a
 class=" ibm-unav-has-child" href="http://www.ibm.com/solutions/cn/zh/">解
决方案</a><div id="gi-4ebca0d" class="ibm-unav-menu"><span 
id="gi-4ebca0d-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li 
class=" ibm-place-holder"><a id="gi-839594e7-trigger" class=" 
ibm-unav-menu-has-child" href="#">按行业分类</a><div id="gi-839594e7" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-839594e7-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/cn/industry/finance/solution/">金融业</a></li><li><a
 href="http://www.ibm.com/cn/industry/finance/solution/banking.shtml">银行
业</a></li><li><a 
href="http://www.ibm.com/cn/industry/finance/solution/insurance.shtml">保
险业</a></li><li><a 
href="http://www.ibm.com/smb/cn/industries/retail/index.shtml?ca=masterhead&amp;me=cndotcom">零
售业</a></li><li><a 
href="http://www.ibm.com/smb/cn/industries/manufacture/index.shtml?ca=masterhead&amp;me=cndotcom">制
造业</a></li><li><a 
href="http://www.ibm.com/cn/industry/distribution/solution/">流通业</a></li><li><a
 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_commu.shtml">电
子行业</a></li><li><a 
href="http://www.ibm.com/cn/industry/telecom/solution/">电信业</a></li><li><a
 
href="http://www.ibm.com/cn/smb/industries/media/index.shtml?ca=masterhead&amp;me=cndotcom">媒
体与娱乐业</a></li><li><a 
href="http://www.ibm.com/cn/industry/distribution/solution/transport.shtml">交
通运输业</a></li><li><a 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_aero.shtml">航
空航天造船业</a></li><li><a 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_auto.shtml">汽
车制造业</a></li><li><a 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_petro.shtml">石
油石化业</a></li><li><a href="http://www.ibm.com/cn/public/offertogov/h/">政府
与公众事业</a></li><li><a 
href="http://www.ibm.com/cn/industry/education/solution/">教育</a></li><li><a
 href="http://www.ibm.com/cn/public/healthcare/solutions/">医疗与生命科学</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-56ec760a-trigger" class=" 
ibm-unav-menu-has-child" href="#">按业务需求分类</a><div id="gi-56ec760a" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-56ec760a-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/smb/cn/business/infrastructure/index.shtml?ca=masterhead&amp;me=cndotcom">IT
 基础架构解决方案</a></li><li><a 
href="http://www.ibm.com/cn/smb/solutions/bi/index.shtml?ca=masterhead&amp;me=cndotcom">商
务智能（BI）</a></li><li><a 
href="http://www.ibm.com/cn/express/business/scm/index.shtml?ca=masterhead&amp;me=cndotcom">供
应链管理（SCM）</a></li><li><a 
href="http://www.ibm.com/cn/express/business/erp/index.shtml?ca=masterhead&amp;me=cndotcom">企
业资源规划（ERP）</a></li><li><a 
href="http://www.ibm.com/cn/smb/solutions/crm/index.shtml?ca=masterhead&amp;me=cndotcom">客
户关系管理（CRM）</a></li><li><a 
href="http://www.ibm.com/cn/smb/solutions/plm/index.shtml?ca=masterhead&amp;me=cndotcom">产
品生命周期管理（PLM）</a></li><li><a 
href="http://www.ibm.com/cn/express/business/oa/index.shtml?ca=masterhead&amp;me=cndotcom">办
公自动化(OA)</a></li><li><a 
href="http://www.ibm.com/cn/express/business/eam/index.shtml?ca=masterhead&amp;me=cndotcom">企
业资产管理(EAM)</a></li><li><a 
href="http://www.ibm.com/software/cn/db2/content-management/industry-solutions/">内
容管理</a></li><li><a 
href="http://www.ibm.com/cn/software/solution/info_conformity.html">信息集成</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-6ea4d585-trigger" class=" 
ibm-unav-menu-has-child" href="#">按顶级业务合作伙伴分类</a><div id="gi-6ea4d585" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-6ea4d585-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/cn/services/hotsale/cisco/index.shtml">IBM 和 
Cisco</a></li><li><a 
href="http://www.ibm.com/cn/services/bcs/alliance/oracle/index.shtml">IBM
 与 Oracle</a></li><li><a 
href="http://www.ibm.com/cn/services/bcs/alliance/sap/index.shtml">IBM 与
 SAP</a></li></ul></div></li><li><a 
href="http://www.ibm.com/cn/services/bcs/">业务咨询</a></li><li><a 
href="http://www.ibm.com/systems/cn/dihub/index.shtml">IBM 动态架构</a></li><li><a
 href="http://www.ibm.com/software/cn/smartwork/">IBM智慧运作</a></li><li><a
 href="http://www.ibm.com/software/cn/nihub/">IBM新锐洞察</a></li><li><a 
href="http://www.ibm.com/software/cn/spsm/">IBM智慧产品与服务</a></li><li><a 
href="http://www.ibm.com/software/cn/soa/launch/index.html">面向服务架构 (SOA)</a></li><li><a
 href="http://www.ibm.com/cn/financing/index.shtml">融资租赁</a></li><li><a 
href="http://www.ibm.com/smb/cn/business/index.shtml?ca=masterhead&amp;me=cndotcom">面
向中型企业及机构的解决方案</a></li><li><a 
href="http://www.ibm.com/software/cn/solution/">软件行业解决方案</a></li><li><a 
href="http://www.ibm.com/city/cn/index.shtml?re=masthead">IBM 区域解决方案</a></li><li><a
 href="http://www.ibm.com/cn/services/bcs/">更多业务解决方案</a></li></ul></div></li><li
 id="ibm-unav-services"><a class=" ibm-unav-has-child" 
href="http://www.ibm.com/technologyservices/cn/zh/">服务</a><div 
id="gi-2226b2a6" class="ibm-unav-menu"><span id="gi-2226b2a6-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li class=" ibm-place-holder"><a 
id="gi-9cf24cd3-trigger" class=" ibm-unav-menu-has-child" href="#">按服务项目
分类</a><div id="gi-9cf24cd3" class="ibm-unav-menu ibm-place-holder"><span
 id="gi-9cf24cd3-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 href="http://www-31.ibm.com/cn/services/managedservices/">弹性运维服务</a></li><li><a
 href="http://www.ibm.com/services/cn/index.wss/itservice/bcrs/c1000411">业
务连续与灾难恢复服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/imc/c1025977">企
业终端用户服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/gn/c1000412">网络
服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025997">IT
 策略与基础架构服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/its/c1000418">维
护与技术支持服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025998">中
间件服务</a></li><li><a 
href="http://www.ibm.com/services/cn/gts/outsourcing.html">外包服务</a></li><li><a
 href="http://www.ibm.com/services/cn/index.wss/itservice/so/c1000405">企
业 IT 安全服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025999">服
务器服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1026000">数
据中心及智能化集成服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/its/c1000416">数
据与存储服务</a></li></ul></div></li><li class=" ibm-place-holder"><a 
id="gi-87bff879-trigger" class=" ibm-unav-menu-has-child" href="#">按业务类型
分类</a><div id="gi-87bff879" class="ibm-unav-menu ibm-place-holder"><span
 id="gi-87bff879-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024566">竞
争策略</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024555">营
运/委外</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024567">顾
客服务及忠诚度</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024553">通
路策略实施</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024556">IT
 最适化</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024568">全
新的工作环境</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024557">灵
活可靠的基础建设</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024554">安
全和防御</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024569">价
值链效益</a></li></ul></div></li><li class=" ibm-place-holder"><a 
id="gi-62768811-trigger" class=" ibm-unav-menu-has-child" href="#">按行业分类</a><div
 id="gi-62768811" class="ibm-unav-menu ibm-place-holder"><span 
id="gi-62768811-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024588">跨
行业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024537">金融
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024548">银行
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024546">保险
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024547">零售
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024540">消费
品</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024545">批发
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024550">电子
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024543">电信
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024538">媒体
与娱乐</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024541">旅游
和运输业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024542">汽车
行业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024552">石油
石化行业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024549">政府
部门</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024644">能源
与公用事业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024544">教育
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024536">医疗
保健</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024539">生命
科学</a></li></ul></div></li><li><a href="http://www.ibm.com/training/cn/">培
训服务</a></li><li><a href="http://www.ibm.com/cn/software/service/">软件服务</a></li><li><a
 
href="http://www.ibm.com/cn/express/products/igs/?ca=masterhead&amp;me=cndotcom">面
向中型企业及机构的服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss">更多服务</a></li></ul></div></li>
<li id="ibm-unav-products"><a class=" ibm-unav-has-child" 
href="http://www.ibm.com/products/cn/zh/">产品</a><div id="gi-e75495d0" 
class="ibm-unav-menu"><span id="gi-e75495d0-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/cn/shop/special.shtml">特惠产品和方案</a></li><li 
class=" ibm-place-holder"><a id="gi-cf1c4580-trigger" class=" 
ibm-unav-menu-has-child" href="#">软件</a><div id="gi-cf1c4580" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-cf1c4580-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/software/">所
有软件</a></li><li><a href="http://www.ibm.com/software/products/cn/zh">产品目
录</a></li><li><a href="http://www.ibm.com/cn/software/db2/">Information 
Management 信息管理软件</a></li><li><a 
href="http://www.ibm.com/cn/software/lotus/">Lotus 协作办公软件</a></li><li><a
 href="http://www.ibm.com/cn/software/rational/">Rational 开发软件</a></li><li><a
 href="http://www.ibm.com/cn/software/tivoli/">Tivoli 服务管理软件</a></li><li><a
 href="http://www.ibm.com/cn/software/websphere/">WebSphere 应用系统和整合软件</a></li><li><a
 href="http://www.ibm.com/cn/software/zseries/">System z 服务器软件</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-2d55dd8b-trigger" class=" 
ibm-unav-menu-has-child" href="#">Systems 与服务器</a><div id="gi-2d55dd8b" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-2d55dd8b-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a href="http://www.ibm.com/systems/cn/">所
有 IBM Systems 和服务器</a></li><li><a 
href="http://www.ibm.com/systems/cn/power/index.shtml">Power Systems</a></li><li><a
 href="http://www.ibm.com/cn/systems/i/index.shtml">System i （i系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/p/">System p （p系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/x/">System x （x系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/z/">System z （z系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/bladecenter/">BladeCenter 刀片服务器</a></li><li><a
 href="http://www.ibm.com/cn/openpower">OpenPower 服务器</a></li><li><a 
href="http://www.ibm.com/cn/servers/eserver/xseries/l1350.shtml">群集服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/unix/">UNIX 服务器</a></li><li><a 
href="http://www.ibm.com/cn/servers/eserver/linux/index.shtml">Linux 服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/power/index.shtml">POWER 处理器的服务器</a></li><li><a
 href="http://www.ibm.com/cn/servers/jump_intel.shtml">基于英特尔架构的服务器</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-36b163b5-trigger" class=" 
ibm-unav-menu-has-child" href="#">存储产品</a><div id="gi-36b163b5" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-36b163b5-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a href="http://www.ibm.com/storage/cn/">所
有存储产品</a></li><li><a href="http://www.ibm.com/storage/cn/disk/">磁盘存储系统</a></li><li><a
 href="http://www.ibm.com/storage/cn/tape/">磁带存储系统</a></li><li><a 
href="http://www.ibm.com/storage/cn/san/">存储区域网络</a></li><li><a 
href="http://www.ibm.com/storage/cn/nas/">网络连接存储</a></li><li><a 
href="http://www.ibm.com/storage/cn/software/">存储软件</a></li><li><a 
href="http://www.ibm.com/storage/cn/product/index.shtml">存储产品排序（A - Z）</a></li></ul></div></li><li><a
 
href="http://www.ibm.com/services/cn/index.wss/offerfamily/igs/c1025846">网
络安全</a></li><li><a href="http://www.ibm.com/cn/products/pos/">零售终端</a></li><li><a
 
href="http://www.infoprintsolutionscompany.com/internet/wwsites.nsf/vwWebPublished/mainT1_cn">打
印机 (InfoPrint)</a></li><li><a 
href="http://www.ibm.com/cn/financing/icpe/">IBM 官方认证再制造设备</a></li><li><a
 href="http://www.ibm.com/cn/servers/eserver/xseries/options.shtml">选件</a></li><li><a
 href="http://www.ibm.com/cn/promotion/esg/xseries/">中低端产品特惠商城</a></li><li><a
 
href="http://www.ibm.com/cn/express/products/hardware/index.shtml?ca=masterhead&amp;me=cndotcom">面
向中型企业及机构的特惠产品</a></li></ul></div></li>
<li style="z-index: 8;" class=" ibm-is-active ibm-is-active 
ibm-is-active ibm-is-active" id="ibm-unav-support"><a class=" 
ibm-unav-has-child" href="http://www.ibm.com/support/cn/zh/">支持与下载</a><div
 style="z-index: 9; display: none;" id="gi-6fb257d3" 
class="ibm-unav-menu"><span style="display: none; height: 208px;" 
id="gi-6fb257d3-ehb" class="ibm-unav-menu-ehb ibm-is-active"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li 
class=" ibm-place-holder"><a style="z-index: 8;" 
id="gi-91493b30-trigger" class=" ibm-unav-menu-has-child " href="#">下载</a><div
 style="z-index: 9; top: -1px; display: none;" id="gi-91493b30" 
class="ibm-unav-menu ibm-place-holder"><span style="display: none; 
height: 37px;" id="gi-91493b30-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 href="http://www.ibm.com/cn/support/download/download.shtml">驱动程序和软件下载</a></li></ul></div></li><li><a
 href="http://www.ibm.com/support/troubleshooting/cn/">故障诊断与排除</a></li><li><a
 href="http://www.ibm.com/support/advsrch.wss?rs=0&amp;loc=zh_CN">搜索</a></li><li
 class=" ibm-place-holder"><a id="gi-573dd8ea-trigger" class=" 
ibm-unav-menu-has-child" href="#">按产品查看</a><div id="gi-573dd8ea" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-573dd8ea-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/cn/support/productsupport/sw_support.shtml">软件产
品</a></li><li><a 
href="http://www.ibm.com/cn/support/productsupport/eserver.shtml">服务器</a></li><li><a
 
href="http://www.ibm.com/cn/support/productsupport/storage_support.shtml">存
储产品</a></li><li><a 
href="http://www.ibm.com/cn/support/productsupport/print_support.shtml">打
印机 (InfoPrint)</a></li></ul></div></li><li><a 
href="http://www.ibm.com/cn/support/mysupport/">个性化支持</a></li><li><a 
href="http://www.ibm.com/support/publications/cn/index.html">产品资料中心</a></li><li
 class=" ibm-place-holder"><a id="gi-ad52ebc0-trigger" class=" 
ibm-unav-menu-has-child" href="#">电子化工具</a><div id="gi-ad52ebc0" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-ad52ebc0-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/support/electronic/uprtransition.wss?category=2&amp;locale=zh_CN">提
交服务请求</a></li><li><a 
href="https://www.ibm.com/support/electronic/portal/%21ut/p/kcxml/04_Sj9SPykssy0xPLMnMz0vM0Y_QjzKLt4y3dAXJgFku-pHIIgbxjnABX4_83FT9IKBEpDlQxCVQPyonNT0xuVI_WN9bP0C_IDc0otzb0REAowWZNg%21%21/delta/base64xml/L2dJQSEvUUt3QS80SVVFLzZfOV85RQ%21%21?category=4&amp;locale=zh_CN">专
项服务</a></li></ul></div></li><li><a 
href="http://www.ibm.com/cn/support/viewdoc/knowledgebase">技术知识库</a></li><li><a
 href="http://www.ibm.com/support/operations/cn">在线客户支持</a></li><li><a 
href="http://www.ibm.com/support/warranties/cn/">保修、许可和维护</a></li></ul></div></li>
<li id="ibm-unav-myibm"><a class=" ibm-unav-has-child" 
href="http://www.ibm.com/account/cn/zh/">个性化服务</a><div id="gi-ab49a122" 
class="ibm-unav-menu"><span id="gi-ab49a122-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/account/myaccounts/cn/zh/">我的账户</a></li><li 
class=" ibm-myinterest"><a id="gi-1fca5b42-trigger" 
href="http://www.ibm.com/account/myibm/myinterestView.do?cc=cn&amp;lc=zh">我
的收藏夹</a><div id="gi-1fca5b42" class="ibm-unav-menu ibm-myinterest"><span
 id="gi-1fca5b42-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul></ul></div></li><li><a
 href="http://www.ibm.com/account/myibm/profile.do?cc=cn&amp;lc=zh">我的概要
信息</a></li><li class=" ibm-place-holder"><a id="gi-793aeea2-trigger" 
class=" ibm-unav-menu-has-child" href="#">客户支持</a><div id="gi-793aeea2" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-793aeea2-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/support/operations/cn/zh/contracts">合同</a></li><li><a
 href="http://www.ibm.com/support/operations/cn/zh/orderdelivery">订单与发货</a></li><li><a
 href="http://www.ibm.com/support/operations/cn/zh/inventory">库存与维护</a></li><li><a
 href="http://www.ibm.com/support/operations/cn/zh/invoicespayments">发票与
付款</a></li><li><a href="http://www.ibm.com/support/operations/cn">更多客户支持</a></li></ul></div></li><li><a
 href="http://www.ibm.com/account/cn/zh/">了解更多</a></li></ul></div></li>
</ul>
</div>

</div>

<!-- MASTHEAD_END -->

<div id="ibm-pcon">

<!-- CONTENT_BEGIN -->
<div id="ibm-content">

<!-- Navigation_Trail_BEGIN -->
<!-- &nbsp; -->
      <div id="ibm-content-head"><ul id="ibm-navigation-trail"><li 
class="ibm-first"><a href="http://www.ibm.com/developerworks/cn/">developerWorks
 中国</a></li><li><a href="http://www.ibm.com/developerworks/cn/java/">Java
 technology</a></li><li><a 
href="http://www.ibm.com/developerworks/cn/views/java/libraryview.jsp">文
档库</a></li></ul></div>
<!-- Navigation_Trail_END -->

<!-- dW_Summary Area_START -->
<div id="dw-summary-article">

<div class="dw-content-head">
<h1>花1K内存实现高效I/O的RandomAccessFile类</h1><p><em>通过扩展RandomAccessFile类使之具备
Buffer改善I/O性能</em></p>
</div>

<div class="ibm-container-body ibm-two-column">

<div class="ibm-column ibm-first">
<div class="author"><a class="dwauthor" rel="#authortip1" 
href="#author1">崔志翔</a> (<a 
href="mailto:bladeinco@citiz.net?subject=%E8%8A%B11K%E5%86%85%E5%AD%98%E5%AE%9E%E7%8E%B0%E9%AB%98%E6%95%88I/O%E7%9A%84RandomAccessFile%E7%B1%BB&amp;cc=bladeinco@citiz.net">bladeinco@citiz.net</a>),
 上海颐东网络信息有限公司产品部经理</div><div style="display: none;" id="authortip1" 
class="dwauthor-onload-state ibm-no-print">崔志翔,上海颐东网络信息有限公司产品部经理，从事软件产品开
发。您可以通过E-mail:
        <a href="mailto:bladeinco@citiz.net?cc=bladeinco@citiz.net">bladeinco@citiz.net</a>与
他取得联系。
      </div>
<p></p>
  <p><b>简介：</b>&nbsp;JAVA的文件随机存取类（RandomAccessFile）的I/O效率较低。通过分析其中原因，提出解
决方案。逐步展示如何创建具备缓存读写能力的文件随机存取类，并进行了优化。通过与其它文件访问类的性能对比，证明了其实用价值。</p>

  <!-- <p class="ibm-no-print"><div id="dw-tag-this" class="ibm-no-print"></div><div id="interestShow" class="ibm-no-print"></div></p> -->
<div id="dw-tag-content" class="ibm-no-print"></div><div 
id="dw-moretags-access" class="ibm-access"></div>
<p class="ibm-no-print"></p><div id="dw-tag-this" class="ibm-no-print"><a
 class="ibm-external-link" onclick="jQuery.launchTagThisWindow(); return
 false;" href="#">标记本文！</a></div><div id="interestShow" 
class="ibm-no-print"></div>
</div>

<div class="ibm-column ibm-second">

<p class="leading"><b>发布日期：</b>&nbsp;2002 年 11 月 18 日
  
<br><b>级别：</b>&nbsp;初级
    

<br><b>访问情况</b>&nbsp;512 次浏览
<br><b>建议:</b>&nbsp;<span id="nCmts">0&nbsp;(<a href="#icomments">添加评论</a>)</span>
<!-- Rating_Area_Begin -->
<!-- Ensure that div id is based on input id and ends with -widget -->	
<input id="art-rating" name="ratinga" value="3" type="hidden"></p><div 
id="art-rating-widget"><a href="javascript:void(0);"><img alt="1 star" 
title="点击评分 1 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><a href="javascript:void(0);"><img alt="2 stars" 
title="点击评分 2 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><a href="javascript:void(0);"><img alt="3 stars" 
title="点击评分 3 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><a href="javascript:void(0);"><img alt="4 stars" 
title="点击评分 4 星" src="index_files/star-off.gif" height="20" width="20"></a><a
 href="javascript:void(0);"><img alt="5 stars" title="点击评分 5 星" 
src="index_files/star-off.gif" height="20" width="20"></a><span 
id="rateTxt">  平均分 （共 3 个评分 ）</span></div>
<script language="JavaScript" type="text/javascript">
// <![CDATA[
 //  widget div id and article id as args
   window.artRating.init('art-rating-widget');
// ]]>
</script>
<!-- Rating_Area_End -->

</div>

</div>
</div>
<!-- dW_Summary_Area_END -->

<!-- CONTENT_BODY -->
<div id="ibm-content-body">

<!-- MAIN_COLUMN_BEGIN -->
<div id="ibm-content-main">

<!-- Related_Searches_Area_And_Overlays_Begin -->

<!-- MAIN_COLUMN_CONTAINER_BEGIN -->
<div class="ibm-container">

<!-- MAIN_COLUMN_CONTENT_BEGIN -->
<p><a name="N10038"><span class="smalltitle">主体：</span></a></p>
      <p>目前最流行的J2SDK版本是1.3系列。使用该版本的开发人员需文件随机存取，就得使用RandomAccessFile类。其
I/O性能较之其它常用开发语言的同类性能差距甚远，严重影响程序的运行效率。</p>
      <p>开发人员迫切需要提高效率，下面分析RandomAccessFile等文件类的源代码，找出其中的症结所在，并加以改进优化，创建一
个"性/价比"俱佳的随机文件访问类BufferedRandomAccessFile。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link 
ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a
 name="1"><span class="atitle">在改进之前先做一个基本测试：逐字节COPY一个12兆的文件（这里牵涉到读和写）。</span></a></p>
      
      <table class="ibm-data-table" border="1" width="60%"><tbody><tr><td>读</td><td>写</td><td>耗
用时间（秒）</td></tr><tr><td>RandomAccessFile</td><td>RandomAccessFile</td><td>95.848</td></tr><tr><td>BufferedInputStream
 + DataInputStream</td><td>BufferedOutputStream + DataOutputStream</td><td>2.935</td></tr></tbody></table>
      <p>我们可以看到两者差距约32倍，RandomAccessFile也太慢了。先看看两者关键部分的源代码，对比分析，找出原因。</p>
      <p>
        <strong>1．1．[RandomAccessFile]</strong>
      </p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">public class RandomAccessFile implements DataOutput, DataInput {
	public final byte readByte() throws IOException {
		int ch = this.read();
		if (ch &lt; 0)
			throw new EOFException();
		return (byte)(ch);
	}
	public native int read() throws IOException; 
	public final void writeByte(int v) throws IOException {
		write(v);
	} 
	public native void write(int b) throws IOException; 
}
</pre></td></tr></tbody></table><br> 
      <p>可见，RandomAccessFile每读/写一个字节就需对磁盘进行一次I/O操作。</p>
      <p>
        <strong>1．2．[BufferedInputStream]</strong>
      </p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">public class BufferedInputStream extends FilterInputStream {
	private static int defaultBufferSize = 2048; 
	protected byte buf[]; // 建立读缓存区
	public BufferedInputStream(InputStream in, int size) {
		super(in);        
		if (size &lt;= 0) {
			throw new IllegalArgumentException("Buffer size &lt;= 0");
		}
		buf = new byte[size];
	}
	public synchronized int read() throws IOException {
		ensureOpen();
		if (pos &gt;= count) {
			fill();
			if (pos &gt;= count)
				return -1;
		}
		return buf[pos++] &amp; 0xff; // 直接从BUF[]中读取
	} 
	private void fill() throws IOException {
	if (markpos &lt; 0)
	    pos = 0;		/* no mark: throw away the buffer */
	else if (pos &gt;= buf.length)	/* no room left in buffer */
	    if (markpos &gt; 0) {	/* can throw away early part of the buffer */
		int sz = pos - markpos;
		System.arraycopy(buf, markpos, buf, 0, sz);
		pos = sz;
		markpos = 0;
	    } else if (buf.length &gt;= marklimit) {
		markpos = -1;	/* buffer got too big, invalidate mark */
		pos = 0;	/* drop buffer contents */
	    } else {		/* grow buffer */
		int nsz = pos * 2;
		if (nsz &gt; marklimit)
		    nsz = marklimit;
		byte nbuf[] = new byte[nsz];
		System.arraycopy(buf, 0, nbuf, 0, pos);
		buf = nbuf;
	    }
	count = pos;
	int n = in.read(buf, pos, buf.length - pos);
	if (n &gt; 0)
	    count = n + pos;
	}
}
</pre></td></tr></tbody></table><br> 
      <p>
        <strong>1．3．[BufferedOutputStream]</strong>
      </p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">public class BufferedOutputStream extends FilterOutputStream {
   protected byte buf[]; // 建立写缓存区
   public BufferedOutputStream(OutputStream out, int size) {
		super(out);
		if (size &lt;= 0) {
			throw new IllegalArgumentException("Buffer size &lt;= 0");
		}
		buf = new byte[size];
    } 
public synchronized void write(int b) throws IOException {
		if (count &gt;= buf.length) {
	   		flushBuffer();
		}
		buf[count++] = (byte)b; // 直接从BUF[]中读取
   }
   private void flushBuffer() throws IOException {
		if (count &gt; 0) {
			out.write(buf, 0, count);
			count = 0;
		}
   }
}
</pre></td></tr></tbody></table><br> 
      <p>可见，Buffered I/O 
putStream每读/写一个字节，若要操作的数据在BUF中，就直接对内存的buf[]进行读/写操作；否则从磁盘相应位置填充buf[]，再直接对
内存的buf[]进行读/写操作，绝大部分的读/写操作是对内存buf[]的操作。</p>
      <p>
        <strong>1．3．小结</strong>
      </p>
      <p>内存存取时间单位是纳秒级（10E-9），磁盘存取时间单位是毫秒级（10E-3），
同样操作一次的开销，内存比磁盘快了百万倍。理论上可以预见，即使对内存操作上万次，花费的时间也远少对于磁盘一次I/O的开销。
显然后者是通过增加位于内存的BUF存取，减少磁盘I/O的开销，提高存取效率的，当然这样也增加了BUF控制部分的开销。从实际应用来看，存取效率提高
了32倍。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link 
ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a
 name="2"><span class="atitle">根据1.3得出的结论，现试着对RandomAccessFile类也加上缓冲读写机
制。</span></a></p>
      
      <p>随机访问类与顺序类不同，前者是通过实现DataInput/DataOutput接口创建的，而后者是扩展
FilterInputStream/FilterOutputStream创建的，不能直接照搬。</p>
      <p>
        <strong>2．1．开辟缓冲区BUF[默认：1024字节]，用作读/写的共用缓冲区。</strong>
      </p>
      <p>
        <strong>2．2．先实现读缓冲。</strong>
      </p>
      <p>读缓冲逻辑的基本原理：</p>
      <p>A 欲读文件POS位置的一个字节。</p>
      <p>B 查BUF中是否存在？若有，直接从BUF中读取，并返回该字符BYTE。</p>
      <p>C 若没有，则BUF重新定位到该POS所在的位置并把该位置附近的BUFSIZE的字节的文件内容填充BUFFER，返回B。</p>
      <p>以下给出关键部分代码及其说明：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">public class BufferedRandomAccessFile extends RandomAccessFile {
//  byte read(long pos)：读取当前文件POS位置所在的字节
//  bufstartpos、bufendpos代表BUF映射在当前文件的首/尾偏移地址。
//  curpos指当前类文件指针的偏移地址。
    public byte read(long pos) throws IOException {
        if (pos &lt; this.bufstartpos || pos &gt; this.bufendpos ) {
            this.flushbuf();
            this.seek(pos);
            if ((pos &lt; this.bufstartpos) || (pos &gt; this.bufendpos)) 
                throw new IOException();
        }
        this.curpos = pos;
        return this.buf[(int)(pos - this.bufstartpos)];
    }
// void flushbuf()：bufdirty为真，把buf[]中尚未写入磁盘的数据，写入磁盘。
    private void flushbuf() throws IOException {
        if (this.bufdirty == true) {
            if (super.getFilePointer() != this.bufstartpos) {
                super.seek(this.bufstartpos);
            }
            super.write(this.buf, 0, this.bufusedsize);
            this.bufdirty = false;
        }
    }
// void seek(long pos)：移动文件指针到pos位置，并把buf[]映射填充至POS
所在的文件块。
    public void seek(long pos) throws IOException {
        if ((pos &lt; this.bufstartpos) || (pos &gt; this.bufendpos)) { // seek pos not in buf
            this.flushbuf();
            if ((pos &gt;= 0) &amp;&amp; (pos &lt;= this.fileendpos) &amp;&amp; (this.fileendpos != 0)) 
{   // seek pos in file (file length &gt; 0)
            	  this.bufstartpos =  pos * bufbitlen / bufbitlen;
                this.bufusedsize = this.fillbuf();
            } else if (((pos == 0) &amp;&amp; (this.fileendpos == 0)) 
|| (pos == this.fileendpos + 1)) 
{   // seek pos is append pos
                this.bufstartpos = pos;
                this.bufusedsize = 0;
            }
            this.bufendpos = this.bufstartpos + this.bufsize - 1;
        }
        this.curpos = pos;
    }
// int fillbuf()：根据bufstartpos，填充buf[]。
    private int fillbuf() throws IOException {
        super.seek(this.bufstartpos);
        this.bufdirty = false;
        return super.read(this.buf);
    }
}
</pre></td></tr></tbody></table><br> 
      <p>至此缓冲读基本实现，逐字节COPY一个12兆的文件（这里牵涉到读和写，用BufferedRandomAccessFile试一下
读的速度）：</p>
      <table class="ibm-data-table" border="1" width="70%"><tbody><tr><td>读</td><td>写</td><td>耗
用时间（秒）</td></tr><tr><td>RandomAccessFile</td><td>RandomAccessFile</td><td>95.848</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedOutputStream
 +
DataOutputStream</td><td>2.813</td></tr><tr><td>BufferedInputStream +
DataInputStream</td><td>BufferedOutputStream +
DataOutputStream</td><td>2.935</td></tr></tbody></table>
      <p>可见速度显著提高，与BufferedInputStream+DataInputStream不相上下。</p>
      <p>
        <strong>2．3．实现写缓冲。</strong>
      </p>
      <p>写缓冲逻辑的基本原理：</p>
      <p>A欲写文件POS位置的一个字节。</p>
      <p>B 查BUF中是否有该映射？若有，直接向BUF中写入，并返回true。</p>
      <p>C若没有，则BUF重新定位到该POS所在的位置，并把该位置附近的
BUFSIZE字节的文件内容填充BUFFER，返回B。</p>
      <p>下面给出关键部分代码及其说明：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">// boolean write(byte bw, long pos)：向当前文件POS位置写入字节BW。
// 根据POS的不同及BUF的位置：存在修改、追加、BUF中、BUF外等情
况。在逻辑判断时，把最可能出现的情况，最先判断，这样可提高速度。
// fileendpos：指示当前文件的尾偏移地址，主要考虑到追加因素
    public boolean write(byte bw, long pos) throws IOException {
        if ((pos &gt;= this.bufstartpos) &amp;&amp; (pos &lt;= this.bufendpos)) { 
// write pos in buf
            this.buf[(int)(pos - this.bufstartpos)] = bw;
            this.bufdirty = true;
            if (pos == this.fileendpos + 1) { // write pos is append pos
                this.fileendpos++;
                this.bufusedsize++;
            }
        } else { // write pos not in buf
            this.seek(pos);
            if ((pos &gt;= 0) &amp;&amp; (pos &lt;= this.fileendpos) &amp;&amp; (this.fileendpos != 0)) 
{ // write pos is modify file
                this.buf[(int)(pos - this.bufstartpos)] = bw;
            } else if (((pos == 0) &amp;&amp; (this.fileendpos == 0)) 
|| (pos == this.fileendpos + 1)) { // write pos is append pos
                this.buf[0] = bw;
                this.fileendpos++;
                this.bufusedsize = 1;
            } else {
                throw new IndexOutOfBoundsException();
            }
            this.bufdirty = true;
        }
        this.curpos = pos;
        return true;
    }
	</pre></td></tr></tbody></table><br> 
      <p>至此缓冲写基本实现，逐字节COPY一个12兆的文件，（这里牵涉到读和写，结合缓冲读，用
BufferedRandomAccessFile试一下读/写的速度）：</p>
      <table class="ibm-data-table" border="1" width="60%"><tbody><tr><td>读</td><td>写</td><td>耗
用时间（秒）</td></tr><tr><td>RandomAccessFile</td><td>RandomAccessFile</td><td>95.848</td></tr><tr><td>BufferedInputStream
 +
DataInputStream</td><td>BufferedOutputStream +
DataOutputStream</td><td>2.935</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedOutputStream
 +
DataOutputStream</td><td>2.813</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedRandomAccessFile</td><td>2.453</td></tr></tbody></table>
      <p>可见综合读/写速度已超越BufferedInput/OutputStream+DataInput/OutputStream。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link 
ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a
 name="3"><span class="atitle">优化BufferedRandomAccessFile。</span></a></p>
      
      <p>优化原则：</p>
      <ul>
        <li>调用频繁的语句最需要优化，且优化的效果最明显。</li>
        <li>多重嵌套逻辑判断时，最可能出现的判断，应放在最外层。</li>
        <li>减少不必要的NEW。</li>
      </ul>
      <p>这里举一典型的例子：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">   public void seek(long pos) throws IOException {
		...
this.bufstartpos =  pos * bufbitlen / bufbitlen; 
// bufbitlen指buf[]的位长，例：若bufsize=1024，则bufbitlen=10。
...
}
</pre></td></tr></tbody></table><br> 
      <p>seek函数使用在各函数中，调用非常频繁，上面加重的这行语句根据pos和bufsize确定buf[]对应当前文件的映射位置，
用"*"、"/"确定，显然不是一个好方法。</p>
      <p>优化一：this.bufstartpos =  (pos &lt;&lt; bufbitlen) &gt;&gt; 
bufbitlen;</p>
      <p>优化二：this.bufstartpos = pos &amp; bufmask;
// this.bufmask = ~((long)this.bufsize - 1);</p>
      <p>两者效率都比原来好，但后者显然更好，因为前者需要两次移位运算、后者只需一次逻辑与运算（bufmask可以预先得出）。</p>
      <p>至此优化基本实现，逐字节COPY一个12兆的文件，（这里牵涉到读和写，结合缓冲读，用优化后
BufferedRandomAccessFile试一下读/写的速度）：</p>
      <table class="ibm-data-table" border="1" width="60%"><tbody><tr><td>读</td><td>写</td><td>耗
用时间（秒）</td></tr><tr><td>RandomAccessFile</td><td>RandomAccessFile</td><td>95.848</td></tr><tr><td>BufferedInputStream
 +
DataInputStream	</td><td>BufferedOutputStream +
DataOutputStream</td><td>2.935</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedOutputStream
 +
DataOutputStream</td><td>2.813</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedRandomAccessFile</td><td>2.453</td></tr><tr><td>BufferedRandomAccessFile
优</td><td>BufferedRandomAccessFile优</td><td>2.197</td></tr></tbody></table>
      <p>可见优化尽管不明显，还是比未优化前快了一些，也许这种效果在老式机上会更明显。</p>
      <p>以上比较的是顺序存取，即使是随机存取，在绝大多数情况下也不止一个BYTE，所以缓冲机制依然有效。而一般的顺序存取类要实现随机存
取就不怎么容易了。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link 
ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a
 name="4"><span class="atitle">需要完善的地方</span></a></p>
      
      <p>提供文件追加功能：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">    public boolean append(byte bw) throws IOException {
        return this.write(bw, this.fileendpos + 1);
    }
</pre></td></tr></tbody></table><br> 
      <p>提供文件当前位置修改功能：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">    public boolean write(byte bw) throws IOException {
        return this.write(bw, this.curpos);
    }
	</pre></td></tr></tbody></table><br> 
      <p>返回文件长度（由于BUF读写的原因，与原来的RandomAccessFile类有所不同）：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">    public long length() throws IOException {
        return this.max(this.fileendpos + 1, this.initfilelen);
    }
	</pre></td></tr></tbody></table><br> 
      <p>返回文件当前指针（由于是通过BUF读写的原因，与原来的RandomAccessFile类有所不同）：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">    public long getFilePointer() throws IOException {
        return this.curpos;
    }
	</pre></td></tr></tbody></table><br> 
      <p>提供对当前位置的多个字节的缓冲写功能：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">    public void write(byte b[], int off, int len) throws IOException {
        long writeendpos = this.curpos + len - 1;
        if (writeendpos &lt;= this.bufendpos) { // b[] in cur buf
System.arraycopy(b, off, this.buf, (int)(this.curpos - this.bufstartpos), 
len);
            this.bufdirty = true;
            this.bufusedsize = (int)(writeendpos - this.bufstartpos + 1);
        } else { // b[] not in cur buf
            super.seek(this.curpos);
            super.write(b, off, len);
        }
        if (writeendpos &gt; this.fileendpos)
            this.fileendpos = writeendpos;
        this.seek(writeendpos+1);
}
    public void write(byte b[]) throws IOException {
        this.write(b, 0, b.length);
    }
</pre></td></tr></tbody></table><br> 
      <p>提供对当前位置的多个字节的缓冲读功能：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">public int read(byte b[], int off, int len) throws IOException {
long readendpos = this.curpos + len - 1;
   if (readendpos &lt;= this.bufendpos &amp;&amp; readendpos &lt;= this.fileendpos ) { 
// read in buf
     	System.arraycopy(this.buf, (int)(this.curpos - this.bufstartpos), 
b, off, len);
   } else { // read b[] size &gt; buf[]
   		if (readendpos &gt; this.fileendpos) { // read b[] part in file
      		len = (int)(this.length() - this.curpos + 1);
       }
       super.seek(this.curpos);
       len = super.read(b, off, len);
       readendpos = this.curpos + len - 1;
   }
       this.seek(readendpos + 1);
       return len;
}
   public int read(byte b[]) throws IOException {
        return this.read(b, 0, b.length);
   }
public void setLength(long newLength) throws IOException {
        if (newLength &gt; 0) {
            this.fileendpos = newLength - 1;
        } else {
            this.fileendpos = 0;
        }
        super.setLength(newLength);
}
    
public void close() throws IOException {
        this.flushbuf();
        super.close();
   	}
	</pre></td></tr></tbody></table><br> 
      <p>至此完善工作基本完成，试一下新增的多字节读/写功能，通过同时读/写1024个字节，来COPY一个12兆的文件，（这里牵涉到读和
写，用完善后BufferedRandomAccessFile试一下读/写的速度）：</p>
      <table class="ibm-data-table" border="1" width="70%"><tbody><tr><td>读</td><td>写</td><td>耗
用时间（秒）</td></tr><tr><td>RandomAccessFile</td><td>RandomAccessFile</td><td>95.848</td></tr><tr><td>BufferedInputStream
 +
DataInputStream</td><td>BufferedOutputStream +
DataOutputStream</td><td>2.935</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedOutputStream
 +
DataOutputStream</td><td>2.813</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedRandomAccessFile</td><td>2.453</td></tr><tr><td>BufferedRandomAccessFile
优</td><td>BufferedRandomAccessFile优</td><td>2.197</td></tr><tr><td>BufferedRandomAccessFile
完</td><td>BufferedRandomAccessFile完</td><td>0.401</td></tr></tbody></table>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link 
ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a
 name="5"><span class="atitle">与JDK1.4新类
MappedByteBuffer+RandomAccessFile的对比？</span></a></p>
      
      <p>JDK1.4提供了NIO类 
，其中MappedByteBuffer类用于映射缓冲，也可以映射随机文件访问，可见JAVA设计者也看到了RandomAccessFile的问题，
并加以改进。怎么通过MappedByteBuffer+RandomAccessFile拷贝文件呢？下面就是测试程序的主要部分：</p>
 
      <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">RandomAccessFile rafi = new RandomAccessFile(SrcFile, "r");
   RandomAccessFile rafo = new RandomAccessFile(DesFile, "rw");
	FileChannel fci = rafi.getChannel();
FileChannel fco = rafo.getChannel();
	long size = fci.size();
	MappedByteBuffer mbbi = fci.map(FileChannel.MapMode.READ_ONLY, 0, size);
MappedByteBuffer mbbo = fco.map(FileChannel.MapMode.READ_WRITE, 0, size);
long start = System.currentTimeMillis();
for (int i = 0; i &lt; size; i++) {
            byte b = mbbi.get(i);
            mbbo.put(i, b);
}
fcin.close();
fcout.close();
rafi.close();
rafo.close();
System.out.println("Spend: "+(double)(System.currentTimeMillis()-start) / 1000 + "s");
</pre></td></tr></tbody></table><br> 
      <p>试一下JDK1.4的映射缓冲读/写功能，逐字节COPY一个12兆的文件，（这里牵涉到读和写）：</p>
      <table class="ibm-data-table" border="1" width="60%"><tbody><tr><td>读</td><td>写</td><td>耗
用时间（秒）</td></tr><tr><td>RandomAccessFile</td><td>RandomAccessFile</td><td>95.848</td></tr><tr><td>BufferedInputStream
 +
DataInputStream</td><td>BufferedOutputStream +
DataOutputStream</td><td>2.935</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedOutputStream
 +
DataOutputStream</td><td>2.813</td></tr><tr><td>BufferedRandomAccessFile</td><td>BufferedRandomAccessFile</td><td>2.453</td></tr><tr><td>BufferedRandomAccessFile
优</td><td>BufferedRandomAccessFile优</td><td>2.197</td></tr><tr><td>BufferedRandomAccessFile
完</td><td>BufferedRandomAccessFile完</td><td>0.401</td></tr><tr><td>MappedByteBuffer+
RandomAccessFile</td><td>MappedByteBuffer+
RandomAccessFile</td><td>1.209</td></tr></tbody></table>
      <p>确实不错，看来JDK1.4比1.3有了极大的进步。如果以后采用1.4版本开发软件时，需要对文件进行随机访问，建议采用
MappedByteBuffer+RandomAccessFile的方式。但鉴于目前采用JDK1.3及以前的版本开发的程序占绝大多数的实际情况，
如果您开发的JAVA程序使用了RandomAccessFile类来随机访问文件，并因其性能不佳，而担心遭用户诟病，请试用本文所提供的
BufferedRandomAccessFile类，不必推翻重写，只需IMPORT 
本类，把所有的RandomAccessFile改为BufferedRandomAccessFile，您的程序的性能将得到极大的提升，您所要做的就
这么简单。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link 
ibm-back-to-top"><a href="#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a
 name="6"><span class="atitle">未来的考虑</span></a></p>
      
      <p>读者可在此基础上建立多页缓存及缓存淘汰机制，以应付对随机访问强度大的应用。</p>
    <!-- CMA ID: 53055 --> <!-- Site ID: 10 --> <!-- XSLT stylesheet used to transform this file:  dw-article-6.0-beta.xsl -->
<br>
<p><a name="resources"><span class="atitle">参考资料 </span></a></p>
      <p>SUN JDK1.3/1.4 SRC。</p>
      <ul><li>
          <a 
href="http://www.ibm.com/developerworks/cn/java/l-javaio/src.zip">
            <em>源代码</em>
          </a>
        <br><br></li></ul>
<p><a name="author"><span class="atitle">关于作者</span></a></p><div 
class="ibm-container ibm-portrait-module ibm-alternate-two"><div 
class="ibm-container-body"><p><a name="author1"> </a>崔志翔,上海颐东网络信息有限公司产品部
经理，从事软件产品开发。您可以通过E-mail:
        <a href="mailto:bladeinco@citiz.net?cc=bladeinco@citiz.net">bladeinco@citiz.net</a>与
他取得联系。
      </p></div></div>
<!-- MAIN_COLUMN_CONTENT_END -->

  <!-- INLINE_COMMENTS_START -->
  <p class="ibm-no-print"><span class="atitle"><a name="icomments">建议</a></span></p>
  <div id="dw-icomments-container" class="ibm-no-print">
    <div class="ibm-alternate-rule"><hr></div>
    <div class="ibm-alternate-rule"><hr></div>
    <!-- Comment_Script -->
    
    <a id="comments" 
href="http://www.ibm.com/developerworks/cn/java/l-javaio/comments"></a>
    <script language="JavaScript" type="text/javascript">
      // <![CDATA[
dwc = {};
dwc.cmts = '条评论';
dwc.signIn = '登录';
dwc.addCmts = '添加评论';
dwc.addCmt = '添加评论';
dwc.viewOrAddCmts = '查看或添加评论';
dwc.reportInapprCont = '举报不良信息';
dwc.reportInapprContLink = 'http://www.ibm.com/developerworks/forums/forum.jspa?forumID=1834';
dwc.postingCmt = '正在发布评论……';
dwc.noCmt = '快来添加第一条评论';
dwc.netwkErr = '在检索评论时出错，请稍后刷新。';
dwc.addACmt = '添加评论';
dwc.instructCmt = '标有星号（<span class="ibm-required">*</span>）的是必填项目。';
dwc.cmt = '评论：';
dwc.btnPost = '发布';
dwc.btnPostAnon = '匿名发布';
dwc.btnClrCmt = '清除评论';
dwc.btnCancel = '取消';
dwc.showRecent = '显示最新的 {1} 条评论'; // {1} is the count to be substituted
dwc.showNext = '显示后 {1} 条评论'; // {1} is the count to be substituted
dwc.showAllCmts = '显示所有评论';
dwc.enterCmt = '请输入评论内容。';
dwc.loginErr = '暂时无法验证您的登录状态，请稍后再试。';
dwc.postErr = '暂时无法发布您的评论，请稍后再试。';
dwc.postBy = '由 <b>{1}</b>  于 {2} '; // {1} is the author to be substituted; {2} is the date
dwc.siteId = 10;
dwc.lang = 'zh_CN';
// ]]>
    </script>
    <script language="JavaScript" src="index_files/insertcomment.js" type="text/javascript">//</script>
    <div id="threadShow"><div id="cmtTog" style=""><p><span id="numCmts">0</span>&nbsp;
条评论 <span class="dw-bar">|</span> <a 
href="http://www.ibm.com/developerworks/dwwi/DWAuthRouter?m=loginpage&amp;lang=zh_CN&amp;d=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Fjava%2Fl-javaio%2Findex.html%23icomments"
 style="display: none;" class="loginLk">登录</a><a id="addCmtLk" 
class="dw-icomment-link">添加评论</a><a class="dw-icomment-report" 
href="http://www.ibm.com/developerworks/forums/forum.jspa?forumID=1834">举
报不良信息</a></p><div class="ibm-alternate-rule"><hr></div><div 
style="display: none;" id="commentForm"><div class="ibm-container"><h2>添
加评论</h2><div class="ibm-container-body"><p>标有星号（<span 
class="ibm-required">*</span>）的是必填项目。</p><span id="infoCmt"></span><div 
class="ibm-rule"><hr></div><form method="post" action="" 
class="ibm-column-form" enctype="multipart/form-data" focus="name" 
name="form"><p><label for="newCmt">评论：<span class="ibm-required">*</span></label><br><textarea
 name="newCmt" id="newCmt" cols="120" rows="4"></textarea></p><div 
class="ibm-alternate-rule"><hr></div><p class="ibm-buttons-row"><input 
value="发布" name="postCmt" class="ibm-btn-arrow-sec" id="postCmt" 
type="button"><span class="ibm-sep">&nbsp;</span><input value="清除评论" 
name="clearCmt" class="ibm-btn-cancel-sec" id="clearCmt" type="button"><span
 class="ibm-sep">&nbsp;</span><input value="取消" name="cancelCmt" 
class="ibm-btn-cancel-sec" id="cancelCmt" type="button"></p></form></div></div></div><div
 id="cmtSect"><div class="comment"><div class="dw-icomment-container"><table
 class="dw-icomment-body" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td><p>快
来添加第一条评论</p></td></tr></tbody></table></div></div></div><div id="paging"><p><a
 style="display: none;" id="lastCmts" class="dw-icomment-link">显示最新的 5 
条评论</a><span style="display: none;" id="cmtDivider"> <span 
class="dw-bar">|</span> </span><a style="display: none;" id="nextCmts" 
class="dw-icomment-link">显示后 5 条评论</a><span style="display: none;" 
id="cmtDivider2"> <span class="dw-bar">|</span> </span><a 
style="display: none;" id="viewAllCmts" class="dw-icomment-link">显示所有评论</a></p></div><p><a
 
href="http://www.ibm.com/developerworks/dwwi/DWAuthRouter?m=loginpage&amp;lang=zh_CN&amp;d=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Fjava%2Fl-javaio%2Findex.html%23icomments"
 style="display: none;" class="loginLk">登录</a><a id="addCmtLk2" 
href="#icomments">添加评论</a></p><div class="ibm-alternate-rule"><hr></div><div
 class="ibm-alternate-rule"><hr></div></div></div>
    <script language="JavaScript" type="text/javascript">
      // <![CDATA[
jQuery('threadShow').insertComment('95%',5,'nCmts','icomments');
// ]]>
    </script>
  </div>
  <!-- INLINE_COMMENTS_END -->
  

  <p class="ibm-ind-link ibm-back-to-top"><a class="ibm-anchor-up-link" 
href="#ibm-pcon">回页首</a></p>
  <p><a href="http://www.ibm.com/developerworks/cn/ibm/trademarks/">商标</a>
 &nbsp;|&nbsp; <a 
href="http://www.ibm.com/developerworks/cn/mydw_terms/">My 
developerWorks 使用条款与条件</a></p>

<!-- Overlays -->
<!-- lk - pull in overlays from ww when required on cn -->
  </div>
<!-- MAIN_COLUMN_CONTAINER_END -->

<!-- Rating_Meta_BEGIN -->
<!--Rating_Meta_BEGIN--><div class="metavalue">static.content.url=http://www.ibm.com/developerworks/js/artrating/</div><div
 class="metavalue">SITE_ID=10</div><div class="metavalue">Zone=Java 
technology</div><div class="metavalue">ArticleID=53055</div><div 
class="metavalue">ArticleTitle=花1K内存实现高效I/O的RandomAccessFile类</div><div 
class="metavalue">publish-date=11182002</div><div class="metavalue">author1-email=bladeinco@citiz.net</div><div
 class="metavalue">author1-email-cc=bladeinco@citiz.net</div><script language="javascript" type="text/javascript">document.write('<div class="metavalue">url='+location.href.replace('<', '%3C')+'</div>');</script><div
 class="metavalue">url=http://www.ibm.com/developerworks/cn/java/l-javaio/index.html</div><!--Rating_Meta_END-->
<!-- Rating_Meta_END -->

</div>
<!-- MAIN_COLUMN_END-->

<!-- RIGHT_COLUMN_BEGIN -->
<div id="ibm-content-sidebar">

<!-- RIGHT_COLUMN_CONTENT_BEGIN --> 
<div class="ibm-container"><h2>内容</h2><div class="ibm-container-body"><img
 alt="" src="index_files/c.gif" height="1" width="1"><ul 
class="ibm-bullet-list"><li><a class="ibm-feature-link" href="#1">在改进之前先
做一个基本测试：逐字节COPY一个12兆的文件（这里牵涉到读和写）。</a></li><li><a 
class="ibm-feature-link" href="#2">根据1.3得出的结论，现试着对RandomAccessFile类也加上缓冲
读写机制。</a></li><li><a class="ibm-feature-link" href="#3">优化
BufferedRandomAccessFile。</a></li><li><a class="ibm-feature-link" 
href="#4">需要完善的地方</a></li><li><a class="ibm-feature-link" href="#5">与
JDK1.4新类MappedByteBuffer+RandomAccessFile的对比？</a></li><li><a 
class="ibm-feature-link" href="#6">未来的考虑</a></li><li><a 
class="ibm-feature-link" href="#resources">参考资料 </a></li><li><a 
class="ibm-feature-link" href="#author">关于作者</a></li><li><a 
class="ibm-feature-link" href="#icomments">建议</a></li></ul></div></div>

 

<!-- Tagging_Start -->
<div id="dw-tag-cloud-container" class="ibm-container dw-hidetag"><h2>标签</h2>
<div id="dw-tag-help"><a class="dwauthor" rel="#tagtip" id="dwtagtip"><img
 alt="Help" src="index_files/help_icon.gif" align="top" height="16" 
width="16"></a></div>
<div style="display: none;" id="tagtip" class="dwauthor-onload-state 
ibm-no-print">使用 <strong>搜索</strong> 文本框在 My developerWorks 
中查找包含该标签的所有内容。<p>使用 <strong>滑动条</strong> 调节标签的数量。</p><p><strong>热门标签</strong>
 显示了特定专区最受欢迎的标签（例如 Java technology，Linux，WebSphere）。</p><p><strong>我的标
签&lt; /strong&gt; 显示了特定专区您标记的标签（例如 Java technology，Linux，WebSphere）。</strong></p></div>
<div class="ibm-access"><strong>使用搜索文本框在 My developerWorks 
中查找包含该标签的所有内容。<em>热门标签</em> 显示了特定专区最受欢迎的标签（例如 Java 
technology，Linux，WebSphere）。<em>我的标签</em> 显示了特定专区您标记的标签（例如 Java 
technology，Linux，WebSphere）。</strong></div>
<div class="ibm-container-body">
<div class="dw-tag-search"><form 
action="//www.ibm.com/developerworks/mydeveloperworks/bookmarks/html" 
method="get" id="actualtagform" onsubmit="popupform(this, 'join')">
<p><label for="tagfield"><strong><strong>搜索所有标签</strong></strong></label>
<strong><input name="lang" value="zh" type="hidden">
<input id="tagfield" name="tag" maxlength="20" size="17" type="text">&nbsp;<input
 src="index_files/short-btn.gif" class="ibm-btn-view" alt="submit 
search" title="提交搜索" value="Search" type="image"></strong></p></form></div>
<div class="ibm-rule"><hr></div>
<div id="dw-tag-select">
<div id="dw-tag-select-popular"><p><strong><strong>热门文章标签</strong>&nbsp;|&nbsp;<br><a
 id="a-my" href="javascript:;">我的文章标签</a><a href="#dw-tag-access" 
class="ibm-access">跳转到标签列表</a></strong></p></div>
<div id="dw-tag-select-my" class="dw-hidetag"><p><strong><a 
id="a-popular" href="javascript:;">热门文章标签</a>&nbsp;|&nbsp;<br><strong>我的
文章标签</strong></strong></p><strong><a href="#dw-tag-access" 
class="ibm-access">跳转到标签列表</a></strong></div>
<div id="dw-tag-cloud"></div><strong>  
</strong></div><strong>   
</strong></div>
</div>
<!-- Tagging_End -->

<!-- Dig_Deeper -->

<!-- High_Visibility_Offer -->

<!-- Special_Offers -->

<!-- RIGHT_COLUMN_CONTENT_END -->

</div>
<!-- RIGHT_COLUMN_END -->

<!-- CONTENT_BODY_END -->
</div>

</div>
<!-- CONTENT_END -->

<strong> <!-- END_IBM-PCON -->
</strong></div>

<!-- FOOTER_BEGIN -->
<div id="ibm-page-tools">
<!-- IBM page tools container -->
</div>
<div id="ibm-footer">
<ul>
<li class="ibm-first"><strong><a href="http://www.ibm.com/ibm/cn/zh/">关于
IBM</a></strong></li>
<li><strong><a href="http://www.ibm.com/privacy/cn/zh/">隐私条约</a></strong></li>
<li><strong><a href="http://www.ibm.com/contact/cn/zh/">联系IBM</a></strong></li>
<li><strong><a href="http://www.ibm.com/legal/cn/zh/">使用条款</a></strong></li>
<li><a href="http://www.ibm.com/ibm/syndication/cn/zh/">IBM RSS 可定制阅读服务</a></li><li><a
 href="http://www.ibm.com/employment/cn/">求才启事</a></li></ul>
<div id="ibm-social-tools"><ul><li><a rel="print" href="#" title="打印本页面"
 class="ibm-share-print"></a></li><li><a rel="email" href="#" 
title="用电子邮件发送本页面" class="ibm-share-email"></a></li></ul></div></div>
<!-- FOOTER_END -->

<strong> <!-- END_IBM-TOP -->
</strong><div id="ibm-overlay-top"></div></div>
<strong> 
 <!-- SCRIPTS_INCLUDE_BEGIN -->
<!-- JQuery start -->
<script type="text/javascript" language="JavaScript" src="index_files/jquery_002.js"></script>
<script type="text/javascript" language="JavaScript" src="index_files/jquery.js"></script>
<script type="text/javascript" language="JavaScript" src="index_files/jquery_003.js"></script>
<script type="text/javascript" language="JavaScript">
	jQuery.noConflict();     
	// Put all your code in your document ready area
	jQuery(document).ready(function(jQuery) {
	// Do jQuery stuff using jQuery 
	jQuery('a.dwauthor').cluetip({
		local: true,
		showTitle: false,
		positionBy: 'bottomTop',
		sticky: true,	
		mouseOutClose: true,
		closeText: '<img src="//dw1.s81c.com/developerworks/js/jquery/cluetip98/i/x.gif" alt="Close" />',
		arrows: false,
		dropShadow: true,
		cluetipClass: 'dwbasic'
		});   	
	});
 </script>
 <!-- JQuery end --><!-- BEGIN: Use this section to set page specific variables for the Unica Page Tag -->
<script language="JavaScript">var NTPT_PGEXTRA="ibmSkillLevel=1&ibmAdoptPhase=667&ibmRole=710";</script>
<!--END --><!-- SCRIPTS_INCLUDE_END -->

</strong><div id="ibm-metrics">
<script src="index_files/stats.js" type="text/javascript">//</script>
</div>

<div style="position: absolute; z-index: 95; display: none;" 
id="cluetip-waitimage"></div><div style="z-index: 96; display: none; 
position: absolute;" id="cluetip"><div style="z-index: 95; opacity: 0.1;
 top: 1px; left: 1px; position: absolute; background-color: rgb(0, 0, 
0);"></div><div style="z-index: 94; opacity: 0.1; top: 2px; left: 2px; 
position: absolute; background-color: rgb(0, 0, 0);"></div><div 
style="z-index: 93; opacity: 0.1; top: 3px; left: 3px; position: 
absolute; background-color: rgb(0, 0, 0);"></div><div style="z-index: 
92; opacity: 0.1; top: 4px; left: 4px; position: absolute; 
background-color: rgb(0, 0, 0);"></div><div style="z-index: 91; opacity:
 0.1; top: 5px; left: 5px; position: absolute; background-color: rgb(0, 
0, 0);"></div><div style="z-index: 90; opacity: 0.1; top: 6px; left: 
6px; position: absolute; background-color: rgb(0, 0, 0);"></div><div 
style="position: relative; z-index: 97;" id="cluetip-outer"><h3 
id="cluetip-title"></h3><div id="cluetip-inner"></div></div><div 
id="cluetip-extra"></div><div style="z-index: 97;" id="cluetip-arrows" 
class="cluetip-arrows"></div></div><div style="position: absolute; 
display: none; z-index: 9999;" id="livemargins_control"><img 
src="index_files/monitor-background-horizontal.png" style="position: 
absolute; left: -77px; top: -5px;" height="5" width="77">	<img 
src="index_files/monitor-background-vertical.png" style="position: 
absolute; left: 0pt; top: -5px;">	<img id="monitor-play-button" 
src="index_files/monitor-play-button.png" 
onmouseover="this.style.opacity=1" onmouseout="this.style.opacity=0.5" 
style="position: absolute; left: 1px; top: 0pt; opacity: 0.5; cursor: 
pointer;"></div></body></html>