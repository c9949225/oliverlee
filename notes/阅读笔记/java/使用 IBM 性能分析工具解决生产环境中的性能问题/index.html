<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head>


  

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>使用 IBM 性能分析工具解决生产环境中的性能问题</title>
<meta http-equiv="PICS-Label" content="(PICS-1.1 
&quot;http://www.icra.org/ratingsv02.html&quot; l gen true r (cz 1 lz 1 
nz 1 oz 1 vz 1) &quot;http://www.rsac.org/ratingsv01.html&quot; l gen 
true r (n 0 s 0 v 0 l 0) &quot;http://www.classify.org/safesurf/&quot; l
 gen true r (SS~~000 1))">
<link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
<link rel="SHORTCUT ICON" href="http://www.ibm.com/favicon.ico">
  <meta name="Owner" content="dw@cn.ibm.com">
  <meta name="DC.Language" scheme="rfc1766" content="zh-CN">
  <meta name="IBM.Country" content="CN">
<meta name="Security" content="Public">
<meta name="IBM.SpecialPurpose" content="SP001">
<meta name="IBM.PageAttributes" content="sid=1003">
<meta name="Source" content="v16 Template Generator">
<meta name="Robots" content="index,follow">
<meta name="Abstract" 
content="性能问题历来是软件系统不可回避的一个棘手问题，一个成功的可交付的软件系统一定要过得了性能这一关，才能修成正果。引起性能问题的因
素很多，没有一概而论的方法依从，需要根据经验具体问题具体分析。本文并不以探讨各种性能问题为重点，而是以一次实战经历为背景，探索解决这类问题的方式
方法，并总结一些最佳实践，希望给那些正在经受性能问题困扰的战友们些许启示。">
<meta name="Description" 
content="性能问题历来是软件系统不可回避的一个棘手问题，一个成功的可交付的软件系统一定要过得了性能这一关，才能修成正果。引起性能问题的因
素很多，没有一概而论的方法依从，需要根据经验具体问题具体分析。本文并不以探讨各种性能问题为重点，而是以一次实战经历为背景，探索解决这类问题的方式
方法，并总结一些最佳实践，希望给那些正在经受性能问题困扰的战友们些许启示。">
<meta name="Keywords" content="内存泄露 , 性能优化 ,heapdump, javacore, tttjca">
<meta name="DC.Date" scheme="iso8601" content="2010-04-09">
<meta name="DC.Type" scheme="IBM_ContentClassTaxonomy" content="CT316">
<meta name="DC.Subject" scheme="IBM_SubjectTaxonomy" content="TT300">
<meta scheme="IBM_WTMCategory" name="IBM.WTMCategory" 
content="SOFDCJVACN">
<meta name="DC.Rights" content="© Copyright&nbsp;IBM 
Corporation&nbsp;2010">
<meta name="IBM.Effective" scheme="W3CDTF" content="2010-04-09">
<meta name="title" content="使用 IBM 性能分析工具解决生产环境中的性能问题">

<!-- HEADER_SCRIPTS_AND_CSS_INCLUDE -->
<link href="index_files/all.css" media="all" rel="stylesheet" 
title="www" type="text/css">
<link href="index_files/screen.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/screen-uas.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/screen-fonts.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/handheld.css" media="handheld" rel="stylesheet" 
title="www" type="text/css">
<link href="index_files/print.css" media="print" rel="stylesheet" 
title="www" type="text/css">
<!-- dW-specific CSS -->
<link href="index_files/dw-screen.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/dw-local-site.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">
<link href="index_files/jquery.css" media="screen,projection" 
rel="stylesheet" title="www" type="text/css">

<script src="index_files/ibmcommon.js" type="text/javascript">//</script><link
 title="IBM Search" 
href="http://www.ibm.com/search/opensearch/description.xml" 
type="application/opensearchdescription+xml" rel="search">
<script src="index_files/dynamicnav.js" type="text/javascript">//</script>
<!-- Pull-down script --> 
<script type="text/javascript" src="index_files/dropdown.js">//</script>
<!-- dW functional JS -->
<script language="JavaScript" src="index_files/urltactic.js" type="text/javascript"></script>
<!-- Rating_START -->

<script language="JavaScript" type="text/javascript">
  // <![CDATA[

 dwr = {};
  dwr.clickhere = '点击评分';
  dwr.stars = '星';
  dwr.star = '星'; 
  dwr.avgRatingOf = '平均分';
  dwr.youRated = '您的评分是';
  dwr.avgRating = '平均分';
  dwr.basedOnVote = '共 {1} 个评分'; // {1} to be substitue by code
  dwr.basedOnVotes = '共 {1} 个评分';
  dwr.leftParen = '（'; 
  dwr.rightParen = ' ）'; 
  dwr.space = ' '; 
  dwr.yourRating = '您的评分';

// ]]>
</script>


<script language="JavaScript" src="index_files/artrating.js" type="text/javascript"></script>
<style type="text/css">
.metavalue {
  display: none;
}
</style>
<!-- Rating_END --><!-- RESERVED_HEADER_INCLUDE -->
<script language="javascript" src="index_files/ajax1.js" type="text/javascript"></script>
<script language="javascript" src="index_files/search_counter-maverick.js" type="text/javascript"></script>
<script language="javascript" src="index_files/request_referer_capture-maverick.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
 <!--
 setDefaultQuery('dwchina');
 //-->
</script>
<script language="JavaScript" type="text/javascript">
 <!--
 function openNewWindow(url,tar,arg){window.open(url,tar,arg);}
 //-->
</script>
  <!-- Include file support -->
  <script language="JavaScript" type="text/javascript">
    (function($) {
    jQuery.extend({
    getInc: function(u,d){
    if(u==null)return;
    jQuery.ajax({
    type: "GET",
    url: u,
    dataType: "text",
    success: function(t) {
    jQuery(d).html(t);
    ibmCommon.initShowHide(jQuery(d).children()[0]);	
    },
    async: true
    });
    }
    });
    })(jQuery);
  </script>
<script charset="UTF-8" src="index_files/flash-detect.js" type="text/javascript" id="flashdetect"></script><script charset="UTF-8" src="index_files/cnzh-utf8.js" type="text/javascript" id="mhMenu"></script><script charset="UTF-8" src="index_files/Controller_002" type="text/javascript" id="dynavEA"></script><script charset="UTF-8" src="index_files/Controller" type="text/javascript" id="wiBundle"></script></head><body
 id="ibm-com">
<div id="ibm-top" class="ibm-landing-page">

<!-- MASTHEAD_BEGIN -->
<div class="ibm-access"><a href="#main">跳转到主要内容</a></div><div 
id="ibm-masthead"><div id="ibm-logo"><a href="http://www.ibm.com/cn/zh/"><img
 src="index_files/ibm-logo.gif" alt="IBM®" height="50" width="110"></a></div><ul
 id="ibm-geo"><li class="ibm-first" id="ibm-country">中国</li><li 
id="ibm-change-country">[ <a 
href="http://www.ibm.com/developerworks/cn/country/">选择</a> ]</li></ul><form
 id="ibm-search-form" 
action="//www.ibm.com/developerworks/search/searchResults.jsp" 
method="get" name="form1"><input name="searchType" value="1" 
type="hidden"><input name="searchSite" value="dWChina" type="hidden"><input
 name="pageLang" value="zh" type="hidden"><input name="langEncoding" 
value="UTF8" type="hidden"><p><span id="ibm-search-scope"><label 
for="sn"><img src="index_files/c_002.gif" alt="Search in:" height="1" 
width="1"></label><select class="input-local" name="searchScope" id="sn"
 size="1"><option value="dW" selected="selected">dW 全部内容</option><option
 value="dW">--------------</option><option value="aixunix">&nbsp;&nbsp;AIX
 and UNIX</option><option value="dmdd">&nbsp;&nbsp;Info Mgmt</option><option
 value="lotusdd">&nbsp;&nbsp;Lotus</option><option value="rdd">&nbsp;&nbsp;Rational</option><option
 value="wsdd">&nbsp;&nbsp;WebSphere</option><option value="dW">--------------</option><option
 value="javaZ">&nbsp;&nbsp;Java technology</option><option 
value="linuxZ">&nbsp;&nbsp;Linux</option><option value="opensrcZ">&nbsp;&nbsp;Open
 source</option><option value="webservZ">&nbsp;&nbsp;SOA &amp; Web 
services</option><option value="webarchZ">&nbsp;&nbsp;Web dev</option><option
 value="xmlZ">&nbsp;&nbsp;XML</option><option value="dW">--------------</option><option
 value="all">IBM 全部内容</option></select></span><label for="q"><img 
alt="搜索:" src="index_files/c_002.gif" height="1" width="1"></label><input
 name="query" maxlength="100" id="q" type="text"><input id="ibm-search" 
class="ibm-btn-search" name="Search" value="搜索" type="submit"></p></form><div
 id="ibm-site-name"><!-- IBM site name container --></div><div 
id="ibm-universal-nav"><ul><li class="ibm-first" id="ibm-unav-home"><a 
href="http://www.ibm.com/cn/zh/">首页</a></li><li id="ibm-unav-solutions"><a
 class=" ibm-unav-has-child" href="http://www.ibm.com/solutions/cn/zh/">解
决方案</a><div id="gi-a5a0c3da" class="ibm-unav-menu"><span 
id="gi-a5a0c3da-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li 
class=" ibm-place-holder"><a id="gi-2ee6cefa-trigger" class=" 
ibm-unav-menu-has-child" href="#">按行业分类</a><div id="gi-2ee6cefa" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-2ee6cefa-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/cn/industry/finance/solution/">金融业</a></li><li><a
 href="http://www.ibm.com/cn/industry/finance/solution/banking.shtml">银行
业</a></li><li><a 
href="http://www.ibm.com/cn/industry/finance/solution/insurance.shtml">保
险业</a></li><li><a 
href="http://www.ibm.com/smb/cn/industries/retail/index.shtml?ca=masterhead&amp;me=cndotcom">零
售业</a></li><li><a 
href="http://www.ibm.com/smb/cn/industries/manufacture/index.shtml?ca=masterhead&amp;me=cndotcom">制
造业</a></li><li><a 
href="http://www.ibm.com/cn/industry/distribution/solution/">流通业</a></li><li><a
 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_commu.shtml">电
子行业</a></li><li><a 
href="http://www.ibm.com/cn/industry/telecom/solution/">电信业</a></li><li><a
 
href="http://www.ibm.com/cn/smb/industries/media/index.shtml?ca=masterhead&amp;me=cndotcom">媒
体与娱乐业</a></li><li><a 
href="http://www.ibm.com/cn/industry/distribution/solution/transport.shtml">交
通运输业</a></li><li><a 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_aero.shtml">航
空航天造船业</a></li><li><a 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_auto.shtml">汽
车制造业</a></li><li><a 
href="http://www.ibm.com/cn/industry/industrial/solution/solu_petro.shtml">石
油石化业</a></li><li><a href="http://www.ibm.com/cn/public/offertogov/h/">政府
与公众事业</a></li><li><a 
href="http://www.ibm.com/cn/industry/education/solution/">教育</a></li><li><a
 href="http://www.ibm.com/cn/public/healthcare/solutions/">医疗与生命科学</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-6899907c-trigger" class=" 
ibm-unav-menu-has-child" href="#">按业务需求分类</a><div id="gi-6899907c" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-6899907c-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/smb/cn/business/infrastructure/index.shtml?ca=masterhead&amp;me=cndotcom">IT
 基础架构解决方案</a></li><li><a 
href="http://www.ibm.com/cn/smb/solutions/bi/index.shtml?ca=masterhead&amp;me=cndotcom">商
务智能（BI）</a></li><li><a 
href="http://www.ibm.com/cn/express/business/scm/index.shtml?ca=masterhead&amp;me=cndotcom">供
应链管理（SCM）</a></li><li><a 
href="http://www.ibm.com/cn/express/business/erp/index.shtml?ca=masterhead&amp;me=cndotcom">企
业资源规划（ERP）</a></li><li><a 
href="http://www.ibm.com/cn/smb/solutions/crm/index.shtml?ca=masterhead&amp;me=cndotcom">客
户关系管理（CRM）</a></li><li><a 
href="http://www.ibm.com/cn/smb/solutions/plm/index.shtml?ca=masterhead&amp;me=cndotcom">产
品生命周期管理（PLM）</a></li><li><a 
href="http://www.ibm.com/cn/express/business/oa/index.shtml?ca=masterhead&amp;me=cndotcom">办
公自动化(OA)</a></li><li><a 
href="http://www.ibm.com/cn/express/business/eam/index.shtml?ca=masterhead&amp;me=cndotcom">企
业资产管理(EAM)</a></li><li><a 
href="http://www.ibm.com/software/cn/db2/content-management/industry-solutions/">内
容管理</a></li><li><a 
href="http://www.ibm.com/cn/software/solution/info_conformity.html">信息集成</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-cf920d5-trigger" class=" 
ibm-unav-menu-has-child" href="#">按顶级业务合作伙伴分类</a><div id="gi-cf920d5" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-cf920d5-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/cn/services/hotsale/cisco/index.shtml">IBM 和 
Cisco</a></li><li><a 
href="http://www.ibm.com/cn/services/bcs/alliance/oracle/index.shtml">IBM
 与 Oracle</a></li><li><a 
href="http://www.ibm.com/cn/services/bcs/alliance/sap/index.shtml">IBM 与
 SAP</a></li></ul></div></li><li><a 
href="http://www.ibm.com/cn/services/bcs/">业务咨询</a></li><li><a 
href="http://www.ibm.com/systems/cn/dihub/index.shtml">IBM 动态架构</a></li><li><a
 href="http://www.ibm.com/software/cn/smartwork/">IBM智慧运作</a></li><li><a
 href="http://www.ibm.com/software/cn/nihub/">IBM新锐洞察</a></li><li><a 
href="http://www.ibm.com/software/cn/spsm/">IBM智慧产品与服务</a></li><li><a 
href="http://www.ibm.com/software/cn/soa/launch/index.html">面向服务架构 (SOA)</a></li><li><a
 href="http://www.ibm.com/cn/financing/index.shtml">融资租赁</a></li><li><a 
href="http://www.ibm.com/smb/cn/business/index.shtml?ca=masterhead&amp;me=cndotcom">面
向中型企业及机构的解决方案</a></li><li><a 
href="http://www.ibm.com/software/cn/solution/">软件行业解决方案</a></li><li><a 
href="http://www.ibm.com/city/cn/index.shtml?re=masthead">IBM 区域解决方案</a></li><li><a
 href="http://www.ibm.com/cn/services/bcs/">更多业务解决方案</a></li></ul></div></li><li
 id="ibm-unav-services"><a class=" ibm-unav-has-child" 
href="http://www.ibm.com/technologyservices/cn/zh/">服务</a><div 
id="gi-f74e7742" class="ibm-unav-menu"><span id="gi-f74e7742-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li class=" ibm-place-holder"><a 
id="gi-353852c8-trigger" class=" ibm-unav-menu-has-child" href="#">按服务项目
分类</a><div id="gi-353852c8" class="ibm-unav-menu ibm-place-holder"><span
 id="gi-353852c8-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 href="http://www-31.ibm.com/cn/services/managedservices/">弹性运维服务</a></li><li><a
 href="http://www.ibm.com/services/cn/index.wss/itservice/bcrs/c1000411">业
务连续与灾难恢复服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/imc/c1025977">企
业终端用户服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/gn/c1000412">网络
服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025997">IT
 策略与基础架构服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/its/c1000418">维
护与技术支持服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025998">中
间件服务</a></li><li><a 
href="http://www.ibm.com/services/cn/gts/outsourcing.html">外包服务</a></li><li><a
 href="http://www.ibm.com/services/cn/index.wss/itservice/so/c1000405">企
业 IT 安全服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025999">服
务器服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1026000">数
据中心及智能化集成服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/itservice/its/c1000416">数
据与存储服务</a></li></ul></div></li><li class=" ibm-place-holder"><a 
id="gi-77f09989-trigger" class=" ibm-unav-menu-has-child" href="#">按业务类型
分类</a><div id="gi-77f09989" class="ibm-unav-menu ibm-place-holder"><span
 id="gi-77f09989-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024566">竞
争策略</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024555">营
运/委外</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024567">顾
客服务及忠诚度</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024553">通
路策略实施</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024556">IT
 最适化</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024568">全
新的工作环境</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024557">灵
活可靠的基础建设</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024554">安
全和防御</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024569">价
值链效益</a></li></ul></div></li><li class=" ibm-place-holder"><a 
id="gi-467917be-trigger" class=" ibm-unav-menu-has-child" href="#">按行业分类</a><div
 id="gi-467917be" class="ibm-unav-menu ibm-place-holder"><span 
id="gi-467917be-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024588">跨
行业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024537">金融
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024548">银行
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024546">保险
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024547">零售
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024540">消费
品</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024545">批发
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024550">电子
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024543">电信
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024538">媒体
与娱乐</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024541">旅游
和运输业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024542">汽车
行业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024552">石油
石化行业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024549">政府
部门</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024644">能源
与公用事业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024544">教育
业</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024536">医疗
保健</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024539">生命
科学</a></li></ul></div></li><li><a href="http://www.ibm.com/training/cn/">培
训服务</a></li><li><a href="http://www.ibm.com/cn/software/service/">软件服务</a></li><li><a
 
href="http://www.ibm.com/cn/express/products/igs/?ca=masterhead&amp;me=cndotcom">面
向中型企业及机构的服务</a></li><li><a 
href="http://www.ibm.com/services/cn/index.wss">更多服务</a></li></ul></div></li>
<li style="z-index: 8;" class=" ibm-is-active" id="ibm-unav-products"><a
 class=" ibm-unav-has-child" href="http://www.ibm.com/products/cn/zh/">产
品</a><div style="z-index: 9; display: none;" id="gi-6b92cc3" 
class="ibm-unav-menu"><span style="display: none; height: 227px;" 
id="gi-6b92cc3-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 href="http://www.ibm.com/cn/shop/special.shtml">特惠产品和方案</a></li><li 
class=" ibm-place-holder"><a id="gi-de412998-trigger" class=" 
ibm-unav-menu-has-child" href="#">软件</a><div id="gi-de412998" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-de412998-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/software/">所
有软件</a></li><li><a href="http://www.ibm.com/software/products/cn/zh">产品目
录</a></li><li><a href="http://www.ibm.com/cn/software/db2/">Information 
Management 信息管理软件</a></li><li><a 
href="http://www.ibm.com/cn/software/lotus/">Lotus 协作办公软件</a></li><li><a
 href="http://www.ibm.com/cn/software/rational/">Rational 开发软件</a></li><li><a
 href="http://www.ibm.com/cn/software/tivoli/">Tivoli 服务管理软件</a></li><li><a
 href="http://www.ibm.com/cn/software/websphere/">WebSphere 应用系统和整合软件</a></li><li><a
 href="http://www.ibm.com/cn/software/zseries/">System z 服务器软件</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-b3193f6a-trigger" class=" 
ibm-unav-menu-has-child" href="#">Systems 与服务器</a><div id="gi-b3193f6a" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-b3193f6a-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a href="http://www.ibm.com/systems/cn/">所
有 IBM Systems 和服务器</a></li><li><a 
href="http://www.ibm.com/systems/cn/power/index.shtml">Power Systems</a></li><li><a
 href="http://www.ibm.com/cn/systems/i/index.shtml">System i （i系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/p/">System p （p系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/x/">System x （x系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/z/">System z （z系列）服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/bladecenter/">BladeCenter 刀片服务器</a></li><li><a
 href="http://www.ibm.com/cn/openpower">OpenPower 服务器</a></li><li><a 
href="http://www.ibm.com/cn/servers/eserver/xseries/l1350.shtml">群集服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/unix/">UNIX 服务器</a></li><li><a 
href="http://www.ibm.com/cn/servers/eserver/linux/index.shtml">Linux 服务器</a></li><li><a
 href="http://www.ibm.com/cn/systems/power/index.shtml">POWER 处理器的服务器</a></li><li><a
 href="http://www.ibm.com/cn/servers/jump_intel.shtml">基于英特尔架构的服务器</a></li></ul></div></li><li
 class=" ibm-place-holder"><a id="gi-913f40-trigger" class=" 
ibm-unav-menu-has-child" href="#">存储产品</a><div id="gi-913f40" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-913f40-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a href="http://www.ibm.com/storage/cn/">所
有存储产品</a></li><li><a href="http://www.ibm.com/storage/cn/disk/">磁盘存储系统</a></li><li><a
 href="http://www.ibm.com/storage/cn/tape/">磁带存储系统</a></li><li><a 
href="http://www.ibm.com/storage/cn/san/">存储区域网络</a></li><li><a 
href="http://www.ibm.com/storage/cn/nas/">网络连接存储</a></li><li><a 
href="http://www.ibm.com/storage/cn/software/">存储软件</a></li><li><a 
href="http://www.ibm.com/storage/cn/product/index.shtml">存储产品排序（A - Z）</a></li></ul></div></li><li><a
 
href="http://www.ibm.com/services/cn/index.wss/offerfamily/igs/c1025846">网
络安全</a></li><li><a href="http://www.ibm.com/cn/products/pos/">零售终端</a></li><li><a
 
href="http://www.infoprintsolutionscompany.com/internet/wwsites.nsf/vwWebPublished/mainT1_cn">打
印机 (InfoPrint)</a></li><li><a 
href="http://www.ibm.com/cn/financing/icpe/">IBM 官方认证再制造设备</a></li><li><a
 href="http://www.ibm.com/cn/servers/eserver/xseries/options.shtml">选件</a></li><li><a
 href="http://www.ibm.com/cn/promotion/esg/xseries/">中低端产品特惠商城</a></li><li><a
 
href="http://www.ibm.com/cn/express/products/hardware/index.shtml?ca=masterhead&amp;me=cndotcom">面
向中型企业及机构的特惠产品</a></li></ul></div></li>
<li id="ibm-unav-support"><a class=" ibm-unav-has-child" 
href="http://www.ibm.com/support/cn/zh/">支持与下载</a><div id="gi-c2b24a35" 
class="ibm-unav-menu"><span id="gi-c2b24a35-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li class=" ibm-place-holder"><a 
id="gi-8f054b07-trigger" class=" ibm-unav-menu-has-child" href="#">下载</a><div
 id="gi-8f054b07" class="ibm-unav-menu ibm-place-holder"><span 
id="gi-8f054b07-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul><li><a
 href="http://www.ibm.com/cn/support/download/download.shtml">驱动程序和软件下载</a></li></ul></div></li><li><a
 href="http://www.ibm.com/support/troubleshooting/cn/">故障诊断与排除</a></li><li><a
 href="http://www.ibm.com/support/advsrch.wss?rs=0&amp;loc=zh_CN">搜索</a></li><li
 class=" ibm-place-holder"><a id="gi-f5701174-trigger" class=" 
ibm-unav-menu-has-child" href="#">按产品查看</a><div id="gi-f5701174" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-f5701174-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/cn/support/productsupport/sw_support.shtml">软件产
品</a></li><li><a 
href="http://www.ibm.com/cn/support/productsupport/eserver.shtml">服务器</a></li><li><a
 
href="http://www.ibm.com/cn/support/productsupport/storage_support.shtml">存
储产品</a></li><li><a 
href="http://www.ibm.com/cn/support/productsupport/print_support.shtml">打
印机 (InfoPrint)</a></li></ul></div></li><li><a 
href="http://www.ibm.com/cn/support/mysupport/">个性化支持</a></li><li><a 
href="http://www.ibm.com/support/publications/cn/index.html">产品资料中心</a></li><li
 class=" ibm-place-holder"><a id="gi-9bc11ff7-trigger" class=" 
ibm-unav-menu-has-child" href="#">电子化工具</a><div id="gi-9bc11ff7" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-9bc11ff7-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/support/electronic/uprtransition.wss?category=2&amp;locale=zh_CN">提
交服务请求</a></li><li><a 
href="https://www.ibm.com/support/electronic/portal/%21ut/p/kcxml/04_Sj9SPykssy0xPLMnMz0vM0Y_QjzKLt4y3dAXJgFku-pHIIgbxjnABX4_83FT9IKBEpDlQxCVQPyonNT0xuVI_WN9bP0C_IDc0otzb0REAowWZNg%21%21/delta/base64xml/L2dJQSEvUUt3QS80SVVFLzZfOV85RQ%21%21?category=4&amp;locale=zh_CN">专
项服务</a></li></ul></div></li><li><a 
href="http://www.ibm.com/cn/support/viewdoc/knowledgebase">技术知识库</a></li><li><a
 href="http://www.ibm.com/support/operations/cn">在线客户支持</a></li><li><a 
href="http://www.ibm.com/support/warranties/cn/">保修、许可和维护</a></li></ul></div></li>
<li id="ibm-unav-myibm"><a class=" ibm-unav-has-child" 
href="http://www.ibm.com/account/cn/zh/">个性化服务</a><div id="gi-c4a09b94" 
class="ibm-unav-menu"><span id="gi-c4a09b94-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/account/myaccounts/cn/zh/">我的账户</a></li><li 
class=" ibm-myinterest"><a id="gi-335de722-trigger" 
href="http://www.ibm.com/account/myibm/myinterestView.do?cc=cn&amp;lc=zh">我
的收藏夹</a><div id="gi-335de722" class="ibm-unav-menu ibm-myinterest"><span
 id="gi-335de722-ehb" class="ibm-unav-menu-ehb"><img 
src="index_files/c.gif" alt=""></span><a class="ibm-access"></a><ul></ul></div></li><li><a
 href="http://www.ibm.com/account/myibm/profile.do?cc=cn&amp;lc=zh">我的概要
信息</a></li><li class=" ibm-place-holder"><a id="gi-d16f3edc-trigger" 
class=" ibm-unav-menu-has-child" href="#">客户支持</a><div id="gi-d16f3edc" 
class="ibm-unav-menu ibm-place-holder"><span id="gi-d16f3edc-ehb" 
class="ibm-unav-menu-ehb"><img src="index_files/c.gif" alt=""></span><a 
class="ibm-access"></a><ul><li><a 
href="http://www.ibm.com/support/operations/cn/zh/contracts">合同</a></li><li><a
 href="http://www.ibm.com/support/operations/cn/zh/orderdelivery">订单与发货</a></li><li><a
 href="http://www.ibm.com/support/operations/cn/zh/inventory">库存与维护</a></li><li><a
 href="http://www.ibm.com/support/operations/cn/zh/invoicespayments">发票与
付款</a></li><li><a href="http://www.ibm.com/support/operations/cn">更多客户支持</a></li></ul></div></li><li><a
 href="http://www.ibm.com/account/cn/zh/">了解更多</a></li></ul></div></li>
</ul>
</div>

</div>

<!-- MASTHEAD_END -->

<div id="ibm-pcon">

<!-- CONTENT_BEGIN -->
<div id="ibm-content">

<!-- Navigation_Trail_BEGIN -->
<!-- &nbsp; -->
      <div id="ibm-content-head"><ul id="ibm-navigation-trail"><li 
class="ibm-first"><a href="http://www.ibm.com/developerworks/cn/">developerWorks
 中国</a></li><li><a href="http://www.ibm.com/developerworks/cn/java/">Java
 technology</a></li><li><a 
href="http://www.ibm.com/developerworks/cn/views/java/libraryview.jsp">文
档库</a></li></ul></div>
<!-- Navigation_Trail_END -->

<!-- dW_Summary Area_START -->
<div id="dw-summary-article">

<div class="dw-content-head">
<h1>使用 IBM 性能分析工具解决生产环境中的性能问题</h1><p>
</p></div>

<div class="ibm-container-body ibm-two-column">

<div class="ibm-column ibm-first">
<div class="author"><a class="dwauthor" rel="#authortip1" 
href="#author1">张 永峰</a>, 软件工程师, IBM</div><div style="display: none;" 
id="authortip1" class="dwauthor-onload-state ibm-no-print">张永峰是 IBM 
中国开发中心的一名软件工程师。</div>
<p></p>
  <p><b>简介：</b>&nbsp;性能问题历来是软件系统不可回避的一个棘手问题，一个成功的可交付的软件系统一定要过得了性能这一关，才能修
成正果。引起性能问题的因素很多，没有一概而论的方法依从，需要根据经验具体问题具体分析。本文并不以探讨各种性能问题为重点，而是以一次实战经历为背
景，探索解决这类问题的方式方法，并总结一些最佳实践，希望给那些正在经受性能问题困扰的战友们些许启示。</p>

  <!-- <p class="ibm-no-print"><div id="dw-tag-this" class="ibm-no-print"></div><div id="interestShow" class="ibm-no-print"></div></p> -->
<div id="dw-tag-content" class="ibm-no-print"></div><div 
id="dw-moretags-access" class="ibm-access"></div>
<p class="ibm-no-print"></p><div id="dw-tag-this" class="ibm-no-print"><a
 class="ibm-external-link" onclick="jQuery.launchTagThisWindow(); return
 false;" href="#">标记本文！</a></div><div id="interestShow" 
class="ibm-no-print"></div>
</div>

<div class="ibm-column ibm-second">

<p class="leading"><b>发布日期：</b>&nbsp;2010 年 4 月 09 日
  
<br><b>级别：</b>&nbsp;中级
    

<br><b>访问情况</b>&nbsp;388 次浏览
<br><b>建议:</b>&nbsp;<span id="nCmts">0&nbsp;(<a href="#icomments">添加评论</a>)</span>
<!-- Rating_Area_Begin -->
<!-- Ensure that div id is based on input id and ends with -widget -->	
<input id="art-rating" name="ratinga" value="5" type="hidden"></p><div 
id="art-rating-widget"><a href="javascript:void(0);"><img alt="1 star" 
title="点击评分 1 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><a href="javascript:void(0);"><img alt="2 stars" 
title="点击评分 2 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><a href="javascript:void(0);"><img alt="3 stars" 
title="点击评分 3 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><a href="javascript:void(0);"><img alt="4 stars" 
title="点击评分 4 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><a href="javascript:void(0);"><img alt="5 stars" 
title="点击评分 5 星" src="index_files/avg-star-on.gif" height="20" 
width="20"></a><span id="rateTxt">  平均分 （共 12 个评分 ）</span></div>
<script language="JavaScript" type="text/javascript">
// <![CDATA[
 //  widget div id and article id as args
   window.artRating.init('art-rating-widget');
// ]]>
</script>
<!-- Rating_Area_End -->

</div>

</div>
</div>
<!-- dW_Summary_Area_END -->

<!-- CONTENT_BODY -->
<div id="ibm-content-body">

<!-- MAIN_COLUMN_BEGIN -->
<div id="ibm-content-main">

<!-- Related_Searches_Area_And_Overlays_Begin -->

<!-- MAIN_COLUMN_CONTAINER_BEGIN -->
<div class="ibm-container">

<!-- MAIN_COLUMN_CONTENT_BEGIN -->
<p><a name="major1"><span class="atitle">序言</span></a></p>
			<p>企业级应用系统软件通常有着对并发数和响应时间的要求，这就要求大量的用户能在高响应时间内完成业务操作。这两个性能指标往往决定着一个应用
系统软件能否成功上线，而这也决定了一个项目最终能否验收成功，能否得到客户认同，能否继续在一个行业发展壮大下去。由此可见性能对于一个应用系统的重要
性，当然这似乎也成了软件行业的不可言说的痛 —— 绝大多数的应用系统在上线之前，项目组成员都要经历一个脱胎换骨的过程。</p>
			<p>       
生产环境的建立包含众多方面，如存储规划、操作系统参数调整、数据库调优、应用系统调优等等。这几方面互相影响，只有经过不断的调整优化，才能达到资源的
最大利用率，满足客户对系统吞吐量和响应时间的要求。在无数次的实践经验中，很多软件专家能够达成一致的是：应用系统本身的优化是至关重要的，否则即使有
再大的内存，也会被消耗殆尽，尤其是产生 OOM（Out Of Memory）的错误的时候，它会贪婪地吃掉你的内存空间，直到系统宕机。</p>
			<p><a name="major2"><span class="atitle">内存泄露 — 难啃的骨头</span></a></p>
			<p>产生 OOM 
的原因有很多种，大体上可以简单地分为两种情况，一种就是物理内存确实有限，发生这种情况时，我们很容易找到原因，但是它一般不会发生在实际的生产环境
中。因为生产环境往往有足以满足应用系统要求的配置，这在项目最初就是根据系统要求进行购置的。</p>
			<p>另外一种引起 OOM 的原因就是应用系统本身对资源的的不恰当使用、配置，引起内存使用持续增加，最终导致 JVM Heap 
Memory 被耗尽，如没有正确释放 JDBC 的 Connection Pool 中的对象，使用 Cache 时没有限制 Cache 
的大小等等。本文并不针对各种情况做讨论，而是以一个项目案例为背景，探索解决这类问题的方式方法，并总结一些最佳实践，供广大开发工程师借鉴参考。</p>
			<p><a name="major3"><span class="atitle">项目背景介绍</span></a></p>
			<p>项目背景：</p>
			<ol>
				<li>内网用户 500 人，需要同时在线进行业务操作（中午休息一小时，晚 6 点下班）。</li>
				<li>生产环境采用传统的主从式，未做 Cluster ，提供 HA 高可用性。</li>
				<li>服务器为 AIX P570，8U，16G，但是只有一半的资源，即 4U，8G 供新系统使用。</li>
			</ol>
			<p>项目三月初上线，此前笔者与架构师曾去客户现场简单部署过一两次，主要是软件的安装，应用的部署，测一下应用是不是能够跑起来，算作是上线前
的准备工作。应用上线（试运行）当天，项目组全体入住客户现场，看着用户登录数不断攀升，大家心里都没有底，高峰时候到了 
440，系统开始有点反应变慢，不过还是扛下来了，最后归结为目前的资源有限，等把另一半资源划过来，就肯定没问题了。（须知增加资源，调优的工作大部分
都要重新做一遍，系统级、数据库级等等，这也是后面为什么建议如果资源可用，最好一步到位的原因。）为了临时解决资源有限的问题，通过和客户协商，决定中
午 12 点半和晚上 11 点通过系统调度重启一次应用服务器，这样，就达到了相隔几个小时，手动清理内存的目的。</p>
			<p>项目在试运行阶段，仍旧有新的子应用开始投入联调，同时客户每天都会提出这样那样的需求变更，如果要的很急的话，就要随时修改，隔天修正使
用。修改后没有充分的时间进行回归测试，新部署的代码难免会有这样那样的问题，遇到过几次这种情况，最后不得不在业务系统使用的时候，对应用系统进行重新
启动，于是就会出现业务终止引起的数据不一致，还要对这些数据进行修正维护，加大了工作量。期间，应用在运行过程中有几次异常缓慢的情形，由于业务不能中
断太久，需要迅速恢复系统投入使用，所以往往是重启一下应用服务器来释放内存。事后检查日志，才发现日志中赫然记录有 OOM 
的错误，这才引起了项目经理的注意，要求架构师对该问题进行进一步研究确认。</p>
			<p>但是几个月过去，问题依旧出现，于是通过客户和公司的协调，请来几位专家，包括操作系统专家、数据库专家，大部分的专家在巡检之后，给出的结
论是：大部分需要调整的参数都已经调整过了，还是要从应用系统本身找原因，看来还是要靠我们自己来解决了。（最终的结果也证明，如此诡异隐蔽的 OOM 
问题是很难一眼就能发现的，工具的作用不可忽视。）</p>
			<p>我们通过对底层封装的框架代码，主要是 DAO 层与数据库交互的统一接口，增加了 log 处理以抓取所有执行时间超过 10 秒钟的 
SQL 语句，记录到应用系统日志中备查。同时通过数据库监控辅助工具给出的建议，对所有超标的 SQL 通过建立 
index，或者修正数据结构（主要是通过建立冗余字段来避免多表关联查询）来进行优化。这样过了几天后，已经基本上不存在执行时间超过 10 秒的 
SQL 语句，可以说我们对应用层的优化已经达标了。</p>
			<p>但是，宕机的问题并没有彻底解决，陆续发生了几次，通过短暂的控制台监控，发现都有线程等待的现象发生，还有两三次产生了几个 G 大小的 
heapdump 文件，同时伴随有 javacore 
文件产生。因为每次宕机的时候都需要紧急处理，不允许长时间监控，只能保留应用服务器日志和产生的 heapdump 
文件，做进一步的研究。通过日志检查，我们发现几次宕机时都发生在相同的某两个业务点上，但是多次对处理该业务功能的代码进行检查分析，仍旧没有找到原
因。看来只能寄希望于宕机产生的 heapdump 和 javacore 了，于是开始重点对 OOM 产生的这些文件进行分析。</p>
			<p><a name="major4"><span class="atitle">IBM 分析工具的使用</span></a></p>
			<p>这里，我们简单介绍一下 heapdump 文件和 javacore 文件。heapdump 文件是一种镜像文件，是指定时刻的 
Java 堆栈的快照。应用程序在发生内存泄露的错误时，往往会生成 heapdump 文件，同时伴随有 javacore 
文件生成，javacore 包含 JVM 
和应用程序相关的在特定时刻的一些诊断信息，如操作系统，内存，应用程序环境，线程等的信息。如本文案例中分析的下图中的 
heapdump.20090602.134015.430370.phd 和 
javacore.20090602.134015.430370.txt。</p>
			<p>由于笔者之前并没有这方面的分析经验，觉得 heapdump 
文件很大，就想当然拿它开刀了。首先是寻找工具，类似的工具有多种，笔者最后选择了 IBM 的 
HeapAnalyzer（http://www.alphaworks.ibm.com/tech/heapanalyzer）。通过对 
heapdump 文件的解析，HeapAnalyzer 
可以分析出哪些对象占用了太多的堆栈空间，从而发现导致内存泄露或者可能引起内存泄露的对象。它的使用很简单，可以从它的 readme 
文档中找到，这里我们简单举个例子如下：</p>
			<table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">#/usr/java50/bin/java – Xmx2000m – jar ha36.jar heapdump.20090602.134015.430370.phd
			</pre></td></tr></tbody></table><br>
			<p>通常我们需要使用较大的 heapsize 来启动 HeapAnalyzer，因为通过 HeapAnalyzer 打开过大的 
heapdump 文件时，也可能会因为 heapsize 不够而产生 OOM 的错误。开始的时候，笔者从服务器上将 heapdump 文件通过 
ftp 下载下来，然后试图通过本机 window 环境进行分析。笔者使用的电脑是 2G 内存，启动 HeapAnalyzer 时指定的是 
1536 M，但是几次都是到 90% 多的时候进度条就停止前进了。迫不得已同时也是为了能达到环境一致的效果，笔者将 HeapAnalyzer 
上传到生产环境，直接在生产环境下打开 heapdump 文件。</p>
			
				<br>
				<img alt="分析 phd 后的结果" src="index_files/001.jpg" height="546" 
width="570">
			<br>
			<p>个人感觉 HeapAnalyzer 
给出的分析结果可读性不强，而且不能准确定位问题，从分析结果看大致是因为加载的对象过多，但是是哪个模块导致的问题就跟踪不到了。笔者开始寻找 
HeapAnalyzer 分析结果相关的资料，试图从这个可读性不强的结果中找到蛛丝马迹，可是许久没有进展，再一次陷入了困境。</p>
			<p>在多次研究 heapdump 文件无果的情况下，笔者开始逐渐将注意力转移到 javacore 
文件上，虽然它比较小，说不定内藏玄机呢。通过多方搜寻，找到了 IBM Thread and Monitor Dump Analyzer for 
Java（以下简称 jca）—— A tool that allows identification of hangs, deadlocks, 
resource contention, and bottlenecks in Java 
threads。通过它自身的这段描述来看，这正是笔者所需要的好工具。</p>
			<p>这个工具的使用和 HeapAnalyzer 一样，非常容易，同样提供了详细的 readme 文档，这里也简单举例如下：</p>
			<table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td
 class="code-outline"><pre class="displaycode">#/usr/java50/bin/java -Xmx1000m -jar jca37.jar
			</pre></td></tr></tbody></table><br>
			
				<br><a name="N100B5"><b>图 2. 通过 xManager 工具登录到 AIX 服务器上打开 jca 的效果图</b></a><br>
				<img alt="启动 jca" src="index_files/002.jpg" height="415" width="553">
			<br>
			<p>笔者直接在生产环境下直接通过它对产生的 javacore 
文件进行分析，令人惊喜的是，其分析结果非常明了，笔者心头的疑云在对结果进行进一步分析核实后也渐渐散去。</p>
			
				<br><a name="N100C6"><b>图 3. jca 对 
javacore.20090602.134015.430370.txt 的分析结果 —— 第一部分</b></a><br>
				<img alt="jca 的分析结果 - 第一部分" src="index_files/003.jpg" height="415" 
width="553">
			<br>
			<p>从图中，我们可以清楚地看到引发错误的原因 —— The failure was caused because the class 
loader limit was exceeded。同时我们还能看出当前生产环境使用的 JRE 版本是：J2RE 5.0 IBM J9 2.3 
AIX ppc-32 build j9vmap3223-20070201 ，这个 SR4 的版本有个问题，我们可以从分析结果图的第二部分的 
NOTE 小节清楚地看到：</p>
			
				<br><a name="N100D7"><b>图 4. jca 对 
javacore.20090602.134015.430370.txt 的分析结果 —— 第二部分</b></a><br>
				<img alt="jca 的分析结果 - 第二部分" src="index_files/004.jpg" height="415" 
width="553">
			<br>
			<p>
				<em>NOTE: Only for Java 5.0 Service Refresh 4 (build date:February 
1st, 2007) and older. When you use delegated class loaders, the JVM can 
create a large number of ClassLoader objects. On IBM Java 5.0 Service 
Refresh 4 and older, the number of class loaders that are permitted is 
limited to 8192 by default and an OutOfMemoryError exception is thrown 
when this limit is exceeded. Use the -Xmxcl parameter to increase the 
number of class loaders allowed to avoid this problem, for example to 
25000, by setting -Xmxcl25000, until the problem is resolved.</em>
			</p>
			<p>原来，OOM 竟然是因为这个原因产生的。那么到底是哪里加载的对象超过了这个 8192 的限制呢？接下来笔者结合分析结果和应用系统 
log 进行了进一步的分析，更加验证了 JCA 分析结果的正确性。</p>
			<p>在分析结果中可以看到 Current Thread ，就是对应引起 OOM 的应用服务器的线程，使用该线程的名称作为关键字在我们的 
log 里进行搜索，迅速定位到了业务点——这是一个定时的调度，其功能是按固定时间间隔以 DBLink 
的方式从外部应用的数据库系统中抽取数据，通过应用层逻辑转换后保存到内网数据库系统中。应用层的逻辑是对所有的业务数据进行循环，对每条业务数据进行到
 POJO 的一一对照转换，这意味这一条业务数据需要 10 几个 POJO 
进行组合对照，也就是说，如果外网在指定的时间间隔内数据量稍大，就会加载大量的对象，使 JVM 的 class loaders  瞬间超过 
8192 的限制，而产生 OOM 的错误，从而使内存不断被消耗，直至宕机。</p>
			<p>jca 还提供了对垃圾回收和线程状态的详细分析数据，可以参考如下两图：</p>
			
				<br><a name="N100F4"><b>图 5. jca 对垃圾回收状态的分析数据</b></a><br>
				<img alt="jca 的分析结果 - 第三部分" src="index_files/005.jpg" height="415" 
width="553">
			<br>
			
				<br><a name="N10102"><b>图 6. jca 对垃圾线程状态的分析数据</b></a><br>
				<img alt="jca 的分析结果 - 第四部分" src="index_files/006.jpg" height="415" 
width="553">
			<br>
			<p>问题核实后，如何进行解决呢？分析结果中也给出了相应的建议，从图 4 的 Recommended 小节我们可以看到：</p>
			<p>Recommended -Xmxcl setting (only for IBM Java 5.0, up to and 
including Service Refresh 4 (build date:February 1st ,2007)) : 10,649 or
 greater。</p>
			<p>为了考虑到对既有旧系统不产生影响，我们没有对 JRE 进行升级，而是采用了分析结果给出的建议，在应用服务器启动后设置 -Xmxcl 
参数为 25000，为验证我们的修改是不是成功解决掉了 OOM 
宕机的问题，笔者取消了对应用服务器的自动重启调度，通过一段时间的监控发现，系统运行良好，一直没有再出现 OOM 而宕机的问题，问题得以最终解决。</p>
			<p><a name="major5"><span class="atitle">总结</span></a></p>
			<ol>
				<li>整体规划
				<p>系统上线前要做好充分的准备工作，这一点很重要，上线计划可不是拍拍脑门就能想出来的，需要很多项目成员的参与。</p>
					<ol type="a">
						<li>项目实施计划书：要包括预计实施目标，双方的实施负责人（包括 backup），协调哪些资源应该找哪些人，详细的阶段性计划等等。</li>
						<li>实施小组：指定具有实施经验的架构师，系统工程师，开发组长组成实施小组，负责生产环境的搭建及调整。成员构成上一定要包含项目组内
的稳定核心人员，以保证能在特殊情况需要时做 backup。核心人员的流动会引起项目风险，尤其是在上线初期的不稳定阶段。</li>
						<li>对可规划使用的资源一定要充分利用，这一点应包含在项目实施计划书内，尽量做到资源一步到位。因为本项目案例中，旧有系统和新系统并
行运行，可用的资源在不断发生变化，期间为解决性能问题，曾尝试将资源分配向新系统倾斜，以尝试是否能解决问题，这在一定程度上也会影响实施的进度。</li>
						<li>需要对核心的配置进行确认，如 JRE 版本，数据库版本等。如果我们在生产环境建立的初期，就把 JRE 
升级到最新的版本，可能就避免了这次 6 个月宕机的煎熬。</li>
					</ol>
				</li>
				<li>压力测试
				<p>大部分具有并发需求的应用系统上线前，都要经过开发团队的压力测试，这样在试运行阶段才能心里有底。本项目案例中，由于工期过于紧张，加之
其他因素，导致压力测试不够充分，虽然 OOM 的问题并不是因为并发数过多产生，但是这一环节是不可忽视的。</p>
				</li>
				<li>攻坚团队
				<p>一个拥有高度的执行力的团队一定是一个责任分明的团队。在应对突发、严重、紧急情况时，要有专门的攻坚团队来解决这类问题，这个团队应该包
括项目组的核心开发人员，有较强的动手能力和研究能力，能够变通解决问题，思路开阔。他们的作用是至关重要的，往往可能决定项目的成败。</p>
				</li>
				<li>信心很重要
				<p>每一次攻坚内存泄露的问题都是一次探险之旅，需要有清醒的意识和头脑，更要凝结你的意志和信心，因为这是一个艰苦的过程。本文案例由发生至
解决有半年之久，当笔者转向分析 javacore 文件后，迅速定位了问题，终于柳暗花明，这种喜悦是难以言表的。</p>
				</li>
				<li>纸上得来终觉浅， 绝知此事要躬行。
				<p>这一条不多说了，有所行，才有所得。</p>
				</li>
			</ol>
		<!-- CMA ID: 481378 --> <!-- Site ID: 10 --> <!-- XSLT stylesheet used to transform this file:  dw-article-6.0-beta.xsl -->
<br>
<p><a name="resources"><span class="atitle">参考资料 </span></a></p><p><b>学习</b></p><ul><li>您
可以通过这里得到更多 <a href="http://www.alphaworks.ibm.com/tech/heapanalyzer/">IBM
 heapanalyzer</a> 的信息。<br><br></li><li>您可以通过这里得到更多 <a 
href="http://www.alphaworks.ibm.com/tech/jca/">IBM Thread and Monitor 
Dump Analyzer for Java</a>的信息。<br><br></li><li>“<a 
href="http://www.ibm.com/developerworks/cn/java/j-ibmtools1/">IBM 的 Java
 诊断，第 1 部分: 介绍面向 Java 的 IBM 转储分析器（IBM Dump Analyzer）</a>”
（developerWorks，2007 年 10 月）：本文介绍 IBM Dump Analyzer for 
Java，并提供该工具所能诊断的各种类型问题的背景信息。<br><br></li><li>“<a 
href="http://www.ibm.com/developerworks/cn/websphere/library/techarticles/0903_suipf_javadump/">利
用 Java dump 进行 JVM 故障诊断</a>”（developerWorks，2009 年 3 月）：本文将向读者介绍利用 Java 
dump 诊断 JVM Crash 和 CPU 饥饿等问题的方法和技巧。<br><br></li><li>“<a 
href="http://www.ibm.com/developerworks/cn/java/j-rtm1/">Java 运行时监控，第 1 
部分：Java 系统运行时性能和可用性监控</a>”（developerWorks，2008 年 8 
月）：运行时性能监控对于实现和维护性能优异的系统至关重要。本文将阐述如何有效地对 Java 性能执行低级粒度的监控。<br><br></li><li>“<a
 href="http://www.ibm.com/developerworks/cn/java/j-lo-jvm-perf/">从虚拟机视角谈
 Java 应用性能优化</a>”（developerWorks，2009 年 12 月）：本文从 Java 
虚拟机的角度，特别是垃圾回收机制来剖析了 Java 应用程序设计需要注意的方面，并总结出了几条非常容易被忽视的设计、编写代码的原则和习惯。<br><br></li><li>
				<a 
href="http://www.ibm.com/developerworks/apps/SendTo?bookstore=safari">技术
书店</a>：浏览关于这些和其他技术主题的图书。<br><br></li><li>
				<a href="http://www.ibm.com/developerworks/cn/java/">developerWorks 
Java 技术专区</a>：数百篇关于 Java 编程各个方面的文章。<br><br></li></ul><p><b>获得产品和技术</b></p><ul><li>下
载 <a href="http://www.ibm.com/developerworks/cn/downloads/">IBM 软件试用版</a>，
体验强大的 DB2®，Lotus®，Rational®，Tivoli®和 WebSphere®软件。<br><br></li></ul><p><b>讨
论</b></p><ul><li>加入 <a 
href="http://www.ibm.com/developerworks/mydeveloperworks" 
onmouseover="linkQueryAppend(this)">developerWorks 社区</a>。<br><br></li><li>查
看 <a href="http://www.ibm.com/developerworks/blogs/" 
onmouseover="linkQueryAppend(this)">developerWorks 博客</a> 的最新信息。<br><br></li></ul>
<p><a name="author"><span class="atitle">关于作者</span></a></p><div 
class="ibm-container ibm-portrait-module ibm-alternate-two"><div 
class="ibm-container-body"><p><a name="author1"> </a>张永峰是 IBM 
中国开发中心的一名软件工程师。</p></div></div>
<!-- MAIN_COLUMN_CONTENT_END -->

  <!-- INLINE_COMMENTS_START -->
  <p class="ibm-no-print"><span class="atitle"><a name="icomments">建议</a></span></p>
  <div id="dw-icomments-container" class="ibm-no-print">
    <div class="ibm-alternate-rule"><hr></div>
    <div class="ibm-alternate-rule"><hr></div>
    <!-- Comment_Script -->
    
    <a id="comments" 
href="http://www.ibm.com/developerworks/cn/java/j-lo-javacore/comments"></a>
    <script language="JavaScript" type="text/javascript">
      // <![CDATA[
dwc = {};
dwc.cmts = '条评论';
dwc.signIn = '登录';
dwc.addCmts = '添加评论';
dwc.addCmt = '添加评论';
dwc.viewOrAddCmts = '查看或添加评论';
dwc.reportInapprCont = '举报不良信息';
dwc.reportInapprContLink = 'http://www.ibm.com/developerworks/forums/forum.jspa?forumID=1834';
dwc.postingCmt = '正在发布评论……';
dwc.noCmt = '快来添加第一条评论';
dwc.netwkErr = '在检索评论时出错，请稍后刷新。';
dwc.addACmt = '添加评论';
dwc.instructCmt = '标有星号（<span class="ibm-required">*</span>）的是必填项目。';
dwc.cmt = '评论：';
dwc.btnPost = '发布';
dwc.btnPostAnon = '匿名发布';
dwc.btnClrCmt = '清除评论';
dwc.btnCancel = '取消';
dwc.showRecent = '显示最新的 {1} 条评论'; // {1} is the count to be substituted
dwc.showNext = '显示后 {1} 条评论'; // {1} is the count to be substituted
dwc.showAllCmts = '显示所有评论';
dwc.enterCmt = '请输入评论内容。';
dwc.loginErr = '暂时无法验证您的登录状态，请稍后再试。';
dwc.postErr = '暂时无法发布您的评论，请稍后再试。';
dwc.postBy = '由 <b>{1}</b>  于 {2} '; // {1} is the author to be substituted; {2} is the date
dwc.siteId = 10;
dwc.lang = 'zh_CN';
// ]]>
    </script>
    <script language="JavaScript" src="index_files/insertcomment.js" type="text/javascript">//</script>
    <div id="threadShow"><div id="cmtTog" style=""><p><span id="numCmts">0</span>&nbsp;
条评论 <span class="dw-bar">|</span> <a 
href="http://www.ibm.com/developerworks/dwwi/DWAuthRouter?m=loginpage&amp;lang=zh_CN&amp;d=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Fjava%2Fj-lo-javacore%2Findex.html%23icomments"
 style="display: none;" class="loginLk">登录</a><a id="addCmtLk" 
class="dw-icomment-link">添加评论</a><a class="dw-icomment-report" 
href="http://www.ibm.com/developerworks/forums/forum.jspa?forumID=1834">举
报不良信息</a></p><div class="ibm-alternate-rule"><hr></div><div 
style="display: none;" id="commentForm"><div class="ibm-container"><h2>添
加评论</h2><div class="ibm-container-body"><p>标有星号（<span 
class="ibm-required">*</span>）的是必填项目。</p><span id="infoCmt"></span><div 
class="ibm-rule"><hr></div><form method="post" action="" 
class="ibm-column-form" enctype="multipart/form-data" focus="name" 
name="form"><p><label for="newCmt">评论：<span class="ibm-required">*</span></label><br><textarea
 name="newCmt" id="newCmt" cols="120" rows="4"></textarea></p><div 
class="ibm-alternate-rule"><hr></div><p class="ibm-buttons-row"><input 
value="发布" name="postCmt" class="ibm-btn-arrow-sec" id="postCmt" 
type="button"><span class="ibm-sep">&nbsp;</span><input value="清除评论" 
name="clearCmt" class="ibm-btn-cancel-sec" id="clearCmt" type="button"><span
 class="ibm-sep">&nbsp;</span><input value="取消" name="cancelCmt" 
class="ibm-btn-cancel-sec" id="cancelCmt" type="button"></p></form></div></div></div><div
 id="cmtSect"><div class="comment"><div class="dw-icomment-container"><table
 class="dw-icomment-body" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td><p>快
来添加第一条评论</p></td></tr></tbody></table></div></div></div><div id="paging"><p><a
 style="display: none;" id="lastCmts" class="dw-icomment-link">显示最新的 5 
条评论</a><span style="display: none;" id="cmtDivider"> <span 
class="dw-bar">|</span> </span><a style="display: none;" id="nextCmts" 
class="dw-icomment-link">显示后 5 条评论</a><span style="display: none;" 
id="cmtDivider2"> <span class="dw-bar">|</span> </span><a 
style="display: none;" id="viewAllCmts" class="dw-icomment-link">显示所有评论</a></p></div><p><a
 
href="http://www.ibm.com/developerworks/dwwi/DWAuthRouter?m=loginpage&amp;lang=zh_CN&amp;d=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Fjava%2Fj-lo-javacore%2Findex.html%23icomments"
 style="display: none;" class="loginLk">登录</a><a id="addCmtLk2" 
href="#icomments">添加评论</a></p><div class="ibm-alternate-rule"><hr></div><div
 class="ibm-alternate-rule"><hr></div></div></div>
    <script language="JavaScript" type="text/javascript">
      // <![CDATA[
jQuery('threadShow').insertComment('95%',5,'nCmts','icomments');
// ]]>
    </script>
  </div>
  <!-- INLINE_COMMENTS_END -->
  

  <p class="ibm-ind-link ibm-back-to-top"><a class="ibm-anchor-up-link" 
href="#ibm-pcon">回页首</a></p>
  <p><a href="http://www.ibm.com/developerworks/cn/ibm/trademarks/">商标</a>
 &nbsp;|&nbsp; <a 
href="http://www.ibm.com/developerworks/cn/mydw_terms/">My 
developerWorks 使用条款与条件</a></p>

<!-- Overlays -->
<!-- lk - pull in overlays from ww when required on cn -->
  </div>
<!-- MAIN_COLUMN_CONTAINER_END -->

<!-- Rating_Meta_BEGIN -->
<!--Rating_Meta_BEGIN--><div class="metavalue">static.content.url=http://www.ibm.com/developerworks/js/artrating/</div><div
 class="metavalue">SITE_ID=10</div><div class="metavalue">Zone=Java 
technology</div><div class="metavalue">ArticleID=481378</div><div 
class="metavalue">ArticleTitle=使用 IBM 性能分析工具解决生产环境中的性能问题</div><div 
class="metavalue">publish-date=04092010</div><div class="metavalue">author1-email=yfzhang_cnnew1@cn.ibm.com</div><div
 class="metavalue">author1-email-cc=</div><script language="javascript" type="text/javascript">document.write('<div class="metavalue">url='+location.href.replace('<', '%3C')+'</div>');</script><div
 class="metavalue">url=http://www.ibm.com/developerworks/cn/java/j-lo-javacore/index.html</div><!--Rating_Meta_END-->
<!-- Rating_Meta_END -->

</div>
<!-- MAIN_COLUMN_END-->

<!-- RIGHT_COLUMN_BEGIN -->
<div id="ibm-content-sidebar">

<!-- RIGHT_COLUMN_CONTENT_BEGIN --> 
<div class="ibm-container"><h2>内容</h2><div class="ibm-container-body"><img
 alt="" src="index_files/c.gif" height="1" width="1"><ul 
class="ibm-bullet-list"><li><a class="ibm-feature-link" href="#major1">序
言</a></li><li><a class="ibm-feature-link" href="#major2">内存泄露 — 难啃的骨头</a></li><li><a
 class="ibm-feature-link" href="#major3">项目背景介绍</a></li><li><a 
class="ibm-feature-link" href="#major4">IBM 分析工具的使用</a></li><li><a 
class="ibm-feature-link" href="#major5">总结</a></li><li><a 
class="ibm-feature-link" href="#resources">参考资料 </a></li><li><a 
class="ibm-feature-link" href="#author">关于作者</a></li><li><a 
class="ibm-feature-link" href="#icomments">建议</a></li></ul></div></div>

 

<!-- Tagging_Start -->
<div id="dw-tag-cloud-container" class="ibm-container dw-hidetag"><h2>标签</h2>
<div id="dw-tag-help"><a class="dwauthor" rel="#tagtip" id="dwtagtip"><img
 alt="Help" src="index_files/help_icon.gif" align="top" height="16" 
width="16"></a></div>
<div style="display: none;" id="tagtip" class="dwauthor-onload-state 
ibm-no-print">使用 <strong>搜索</strong> 文本框在 My developerWorks 
中查找包含该标签的所有内容。<p>使用 <strong>滑动条</strong> 调节标签的数量。</p><p><strong>热门标签</strong>
 显示了特定专区最受欢迎的标签（例如 Java technology，Linux，WebSphere）。</p><p><strong>我的标
签&lt; /strong&gt; 显示了特定专区您标记的标签（例如 Java technology，Linux，WebSphere）。</strong></p></div>
<div class="ibm-access"><strong>使用搜索文本框在 My developerWorks 
中查找包含该标签的所有内容。<em>热门标签</em> 显示了特定专区最受欢迎的标签（例如 Java 
technology，Linux，WebSphere）。<em>我的标签</em> 显示了特定专区您标记的标签（例如 Java 
technology，Linux，WebSphere）。</strong></div>
<div class="ibm-container-body">
<div class="dw-tag-search"><form 
action="//www.ibm.com/developerworks/mydeveloperworks/bookmarks/html" 
method="get" id="actualtagform" onsubmit="popupform(this, 'join')">
<p><label for="tagfield"><strong><strong>搜索所有标签</strong></strong></label>
<strong><input name="lang" value="zh" type="hidden">
<input id="tagfield" name="tag" maxlength="20" size="17" type="text">&nbsp;<input
 src="index_files/short-btn.gif" class="ibm-btn-view" alt="submit 
search" title="提交搜索" value="Search" type="image"></strong></p></form></div>
<div class="ibm-rule"><hr></div>
<div id="dw-tag-select">
<div id="dw-tag-select-popular"><p><strong><strong>热门文章标签</strong>&nbsp;|&nbsp;<br><a
 id="a-my" href="javascript:;">我的文章标签</a><a href="#dw-tag-access" 
class="ibm-access">跳转到标签列表</a></strong></p></div>
<div id="dw-tag-select-my" class="dw-hidetag"><p><strong><a 
id="a-popular" href="javascript:;">热门文章标签</a>&nbsp;|&nbsp;<br><strong>我的
文章标签</strong></strong></p><strong><a href="#dw-tag-access" 
class="ibm-access">跳转到标签列表</a></strong></div>
<div id="dw-tag-cloud"></div><strong>  
</strong></div><strong>   
</strong></div>
</div>
<!-- Tagging_End -->

<!-- Dig_Deeper -->

<!-- High_Visibility_Offer -->

<!-- Special_Offers -->

<!-- RIGHT_COLUMN_CONTENT_END -->

</div>
<!-- RIGHT_COLUMN_END -->

<!-- CONTENT_BODY_END -->
</div>

</div>
<!-- CONTENT_END -->

<strong> <!-- END_IBM-PCON -->
</strong></div>

<!-- FOOTER_BEGIN -->
<div id="ibm-page-tools">
<!-- IBM page tools container -->
</div>
<div id="ibm-footer">
<ul>
<li class="ibm-first"><strong><a href="http://www.ibm.com/ibm/cn/zh/">关于
IBM</a></strong></li>
<li><strong><a href="http://www.ibm.com/privacy/cn/zh/">隐私条约</a></strong></li>
<li><strong><a href="http://www.ibm.com/contact/cn/zh/">联系IBM</a></strong></li>
<li><strong><a href="http://www.ibm.com/legal/cn/zh/">使用条款</a></strong></li>
<li><a href="http://www.ibm.com/ibm/syndication/cn/zh/">IBM RSS 可定制阅读服务</a></li><li><a
 href="http://www.ibm.com/employment/cn/">求才启事</a></li></ul>
<div id="ibm-social-tools"><ul><li><a rel="print" href="#" title="打印本页面"
 class="ibm-share-print"></a></li><li><a rel="email" href="#" 
title="用电子邮件发送本页面" class="ibm-share-email"></a></li></ul></div></div>
<!-- FOOTER_END -->

<strong> <!-- END_IBM-TOP -->
</strong><div id="ibm-overlay-top"></div></div>
<strong> 
 <!-- SCRIPTS_INCLUDE_BEGIN -->
<!-- JQuery start -->
<script type="text/javascript" language="JavaScript" src="index_files/jquery_002.js"></script>
<script type="text/javascript" language="JavaScript" src="index_files/jquery.js"></script>
<script type="text/javascript" language="JavaScript" src="index_files/jquery_003.js"></script>
<script type="text/javascript" language="JavaScript">
	jQuery.noConflict();     
	// Put all your code in your document ready area
	jQuery(document).ready(function(jQuery) {
	// Do jQuery stuff using jQuery 
	jQuery('a.dwauthor').cluetip({
		local: true,
		showTitle: false,
		positionBy: 'bottomTop',
		sticky: true,	
		mouseOutClose: true,
		closeText: '<img src="//dw1.s81c.com/developerworks/js/jquery/cluetip98/i/x.gif" alt="Close" />',
		arrows: false,
		dropShadow: true,
		cluetipClass: 'dwbasic'
		});   	
	});
 </script>
 <!-- JQuery end --><!-- BEGIN: Use this section to set page specific variables for the Unica Page Tag -->
<script language="JavaScript">var NTPT_PGEXTRA="ibmSkillLevel=3&ibmAdoptPhase=650&ibmRole=710";</script>
<!--END --><!-- SCRIPTS_INCLUDE_END -->

</strong><div id="ibm-metrics">
<script src="index_files/stats.js" type="text/javascript">//</script>
</div>

<div style="position: absolute; z-index: 95; display: none;" 
id="cluetip-waitimage"></div><div style="z-index: 96; display: none; 
position: absolute;" id="cluetip"><div style="z-index: 95; opacity: 0.1;
 top: 1px; left: 1px; position: absolute; background-color: rgb(0, 0, 
0);"></div><div style="z-index: 94; opacity: 0.1; top: 2px; left: 2px; 
position: absolute; background-color: rgb(0, 0, 0);"></div><div 
style="z-index: 93; opacity: 0.1; top: 3px; left: 3px; position: 
absolute; background-color: rgb(0, 0, 0);"></div><div style="z-index: 
92; opacity: 0.1; top: 4px; left: 4px; position: absolute; 
background-color: rgb(0, 0, 0);"></div><div style="z-index: 91; opacity:
 0.1; top: 5px; left: 5px; position: absolute; background-color: rgb(0, 
0, 0);"></div><div style="z-index: 90; opacity: 0.1; top: 6px; left: 
6px; position: absolute; background-color: rgb(0, 0, 0);"></div><div 
style="position: relative; z-index: 97;" id="cluetip-outer"><h3 
id="cluetip-title"></h3><div id="cluetip-inner"></div></div><div 
id="cluetip-extra"></div><div style="z-index: 97;" id="cluetip-arrows" 
class="cluetip-arrows"></div></div><div style="position: absolute; 
display: none; z-index: 9999;" id="livemargins_control"><img 
src="index_files/monitor-background-horizontal.png" style="position: 
absolute; left: -77px; top: -5px;" height="5" width="77">	<img 
src="index_files/monitor-background-vertical.png" style="position: 
absolute; left: 0pt; top: -5px;">	<img id="monitor-play-button" 
src="index_files/monitor-play-button.png" 
onmouseover="this.style.opacity=1" onmouseout="this.style.opacity=0.5" 
style="position: absolute; left: 1px; top: 0pt; opacity: 0.5; cursor: 
pointer;"></div></body></html>